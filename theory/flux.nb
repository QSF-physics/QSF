(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     66546,       1757]
NotebookOptionsPosition[     63706,       1702]
NotebookOutlinePosition[     64136,       1719]
CellTagsIndexPosition[     64093,       1716]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Introduction", "Section",
 CellChangeTimes->{{3.85064079412921*^9, 
  3.850640795984791*^9}},ExpressionUUID->"672cf219-ec5f-4bcf-89ca-\
4b3929bd5614"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"\[Del]", "\[CenterDot]", "j"}], "+", 
    FractionBox[
     RowBox[{"\[PartialD]", "\[Rho]"}], 
     RowBox[{"\[PartialD]", "t"}]]}], "=", "0"}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.830788819710783*^9, 
  3.830788829526495*^9}},ExpressionUUID->"ff1be03c-e57e-49d6-b955-\
ad70e9bbb8c7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Implementation", "Section",
 CellChangeTimes->{{3.85064080072523*^9, 
  3.850640802674426*^9}},ExpressionUUID->"b69eea4b-04c8-42c6-b723-\
d616c42e9c82"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Epsilon]", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zero", "=", "0"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"corresponds", " ", "to", " ", "previewMask", 
    RowBox[{"(", ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"val2int", "[", "f_", "]"}], ":=", 
   RowBox[{"zero", "+", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ">", "\[Epsilon]"}], ",", "1", ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "<", 
         RowBox[{"-", "\[Epsilon]"}]}], ",", "2", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "f", "]"}], "<", "2"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ">", "\[Epsilon]"}], ",", "3", 
            ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"f", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "<", 
               RowBox[{"-", "\[Epsilon]"}]}], ",", "4", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "f", "]"}], "<", "3"}], ",", "0", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"f", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ">", "\[Epsilon]"}], ",", 
                  "5", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "<", 
                    RowBox[{"-", "\[Epsilon]"}]}], ",", "6", ",", "0"}], 
                   "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
       "]"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minMax", "=", 
   RowBox[{"zero", "+", 
    RowBox[{"{", 
     RowBox[{"0", ",", "6"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"color", "=", 
   RowBox[{
    RowBox[{"Blend", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Transparent", ",", 
        RowBox[{"(*", 
         RowBox[{"x", ">", "0"}], "*)"}], "Red", ",", 
        RowBox[{"(*", 
         RowBox[{"x", "<", "0"}], "*)"}], "Blue", ",", 
        RowBox[{"(*", 
         RowBox[{"y", ">", "0"}], "*)"}], "Green", ",", 
        RowBox[{"(*", 
         RowBox[{"y", "<", "0"}], "*)"}], "Purple", ",", 
        RowBox[{"(*", 
         RowBox[{"z", ">", "0"}], "*)"}], "Black", ",", 
        RowBox[{"(*", 
         RowBox[{"z", "<", "0"}], "*)"}], "Yellow"}], "}"}], ",", 
      RowBox[{"Rescale", "[", 
       RowBox[{"#", ",", "minMax"}], "]"}]}], "]"}], "&"}]}], ";"}]}], "Input",\

 CellLabel->
  "In[179]:=",ExpressionUUID->"a1e06307-bcd1-4f29-af6d-86b8155fad90"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"n", "=", "128"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n2", "=", 
     RowBox[{"n", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CAP", "=", 
     RowBox[{"n", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NS", "=", 
     RowBox[{"IntegerPart", "[", 
      RowBox[{"0.25", " ", 
       RowBox[{"CAP", " ", "/", "1.54"}]}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{"8", ",", " ", "r3"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"SD", "=", 
     RowBox[{"IntegerPart", "[", 
      RowBox[{"0.5", " ", "NS"}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{"5", ",", "r2"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"DT", "=", 
     RowBox[{"IntegerPart", "[", 
      RowBox[{"0.5", " ", "SD"}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{"3", ",", "r1"}], "*)"}], "\[IndentingNewLine]"}]}]}]], "Input",
 CellChangeTimes->{{3.8506408774625998`*^9, 3.850640878114201*^9}, {
  3.850640937581905*^9, 3.850640947718569*^9}, {3.850641046355488*^9, 
  3.850641183140547*^9}, {3.850641397146315*^9, 3.850641424646236*^9}, {
  3.8506415568929567`*^9, 3.8506415576656427`*^9}, {3.850641627073496*^9, 
  3.8506416273566017`*^9}, {3.8506416815856543`*^9, 3.850641722987315*^9}, {
  3.850641817871861*^9, 3.850641818047823*^9}, {3.850642004483333*^9, 
  3.850642004891467*^9}, {3.8506433807941628`*^9, 3.850643381300602*^9}, {
  3.850644038912675*^9, 3.8506440408103113`*^9}, {3.8506459324492702`*^9, 
  3.850645991380752*^9}},
 CellLabel->
  "In[1435]:=",ExpressionUUID->"52b55510-899c-4218-b6ef-b5425140935c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"real", " ", "grid"}], " ", "-", " ", 
    RowBox[{"example", " ", "grid", " ", "conversion"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dx", "=", "0.6"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"realGrid", "=", "2048"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"realRatio", "=", 
     RowBox[{"realGrid", "/", "n"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ticksCount", "=", "14"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rng", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rng2", "=", 
     RowBox[{"realRatio", " ", "rng"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"divs", "=", 
     RowBox[{"Most", "@", 
      RowBox[{"Rest", "@", 
       RowBox[{"FindDivisions", "[", 
        RowBox[{
         RowBox[{"rng", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Last", "@", "rng"}], "+", "1"}], ")"}], "/", "2"}]}], 
         ",", "ticksCount"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ticks", "=", " ", 
     RowBox[{"realRatio", " ", 
      RowBox[{"(", 
       RowBox[{"n2", "-", "0.5", "+", "divs"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ticksI", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ticks", ",", " ", 
        RowBox[{"realRatio", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Last", "@", "rng"}], "+", "1"}], ")"}], "/", "2"}], 
           "+", "divs"}], ")"}]}]}], "}"}], "\[Transpose]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ticksP", "=", 
     RowBox[{"dx", " ", "realRatio", "  ", "divs"}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ticksP", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ticks", ",", 
        RowBox[{"ticksP", "-", 
         RowBox[{"Mean", "[", "ticksP", "]"}]}]}], "}"}], "\[Transpose]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.850641249174798*^9, 3.850641293899043*^9}, {
   3.850641737945483*^9, 3.850641741487214*^9}, {3.8506417824007597`*^9, 
   3.850641800912644*^9}, {3.850641933699938*^9, 3.850641946064355*^9}, {
   3.850642007193524*^9, 3.850642042094871*^9}, {3.85064207963406*^9, 
   3.850642133860955*^9}, {3.8506421762074757`*^9, 3.850642616499238*^9}, 
   3.850642659609644*^9, {3.850642815188849*^9, 3.850642818098035*^9}, {
   3.850642955350956*^9, 3.850642956508395*^9}, {3.850643098712818*^9, 
   3.850643157970304*^9}, {3.8506431989259977`*^9, 3.8506432390469847`*^9}, {
   3.85064326948536*^9, 3.850643495957769*^9}, {3.850643563944529*^9, 
   3.850643586396407*^9}, {3.850643629607499*^9, 3.8506437218121843`*^9}, {
   3.850643782973604*^9, 3.850643916850967*^9}, {3.850644084532777*^9, 
   3.850644085195486*^9}, {3.850645446567676*^9, 3.8506454649952*^9}, {
   3.85064550256348*^9, 3.850645503416873*^9}, {3.850645638577421*^9, 
   3.850645696236351*^9}, {3.850645749718536*^9, 3.8506457507056007`*^9}, {
   3.8506458132141*^9, 3.850645831322865*^9}, {3.8506460165172777`*^9, 
   3.850646022403281*^9}, {3.850646052990951*^9, 3.850646086434239*^9}, {
   3.850646150589753*^9, 3.850646152441272*^9}, {3.8506462340097427`*^9, 
   3.8506462743580523`*^9}},
 CellLabel->
  "In[1575]:=",ExpressionUUID->"a60ca76a-69d3-41c7-ac67-cf6980809b10"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "outwards", " ", "oriented", " ", "point", " ", "boundary", " ", "at", " ",
     "iat"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Rn", "[", 
      RowBox[{"i_", ",", "il_", ",", "ir_"}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"i", ">=", "il"}], "&&", 
       RowBox[{"i", "<", "ir"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Rn2", "[", 
      RowBox[{"i_", ",", "il_", ",", "ir_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Rn", "[", 
       RowBox[{"i", ",", "il", ",", "ir"}], "]"}], "||", 
      RowBox[{"Rn", "[", 
       RowBox[{"i", ",", 
        RowBox[{"-", "ir"}], ",", 
        RowBox[{"-", "il"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "because", " ", "zero", " ", "is", " ", "not", " ", "at", " ", "n2", "*", 
     "dx", " ", "but", " ", "at", " ", 
     RowBox[{"(", 
      RowBox[{"n2", "-", "0.5"}], ")"}], "*", "dx"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PointB", "[", 
      RowBox[{"i_", ",", "iat_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"i", "\[Equal]", 
        RowBox[{"iat", "-", "1"}]}], ",", 
       RowBox[{"Sign", "[", "i", "]"}], ",", "0"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PointB2", "[", 
      RowBox[{"i_", ",", "iat_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"i", "\[Equal]", 
         RowBox[{"iat", "-", "1"}]}], "||", 
        RowBox[{"i", "\[Equal]", 
         RowBox[{"-", "iat"}]}]}], ",", 
       RowBox[{"Sign", "[", "i", "]"}], ",", "0"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "outwards", " ", "oriented", " ", "line", " ", "boundary", " ", "at", " ",
      "jat", " ", "from", " ", "il", " ", "to", " ", "ir"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SegmentB", "[", 
      RowBox[{"i_", ",", "j_", ",", "jat_", ",", "il_", ",", "ir_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Rn", "[", 
        RowBox[{"i", ",", "il", ",", "ir"}], "]"}], ",", 
       RowBox[{"PointB", "[", 
        RowBox[{"j", ",", "jat"}], "]"}], ",", "0"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SegmentBi2", "[", 
      RowBox[{"i_", ",", "j_", ",", "jat_", ",", "il_", ",", "ir_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Rn2", "[", 
        RowBox[{"i", ",", "il", ",", "ir"}], "]"}], ",", 
       RowBox[{"PointB", "[", 
        RowBox[{"j", ",", "jat"}], "]"}], ",", "0"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SegmentBj2", "[", 
      RowBox[{"i_", ",", "j_", ",", "jat_", ",", "il_", ",", "ir_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Rn", "[", 
        RowBox[{"i", ",", "il", ",", "ir"}], "]"}], ",", 
       RowBox[{"PointB2", "[", 
        RowBox[{"j", ",", "jat"}], "]"}], ",", "0"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SegmentBi2j2", "[", 
      RowBox[{"i_", ",", "j_", ",", "jat_", ",", "il_", ",", "ir_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Rn2", "[", 
        RowBox[{"i", ",", "il", ",", "ir"}], "]"}], ",", 
       RowBox[{"PointB2", "[", 
        RowBox[{"j", ",", "jat"}], "]"}], ",", "0"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "outwards", " ", "oriented", " ", "plane", " ", "boundary", " ", "at", 
     " ", "kat", " ", "from", " ", "il", " ", "to", " ", "ir", " ", "and", 
     " ", "jl", " ", "to", " ", "jr"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PatchB", "[", 
      RowBox[{
      "i_", ",", "j_", ",", "k_", ",", "kat_", ",", "il_", ",", "ir_", ",", 
       "jl_", ",", "jr_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Rn", "[", 
        RowBox[{"i", ",", "il", ",", "ir"}], "]"}], ",", 
       RowBox[{"SegmentB", "[", 
        RowBox[{"j", ",", "k", ",", "kat", ",", "jl", ",", "jr"}], "]"}], ",",
        "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PatchBi2", "[", 
      RowBox[{
      "i_", ",", "j_", ",", "k_", ",", "kat_", ",", "il_", ",", "ir_", ",", 
       "jl_", ",", "jr_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Rn2", "[", 
        RowBox[{"i", ",", "il", ",", "ir"}], "]"}], ",", 
       RowBox[{"SegmentB", "[", 
        RowBox[{"j", ",", "k", ",", "kat", ",", "jl", ",", "jr"}], "]"}], ",",
        "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PatchBj2", "[", 
      RowBox[{
      "i_", ",", "j_", ",", "k_", ",", "kat_", ",", "il_", ",", "ir_", ",", 
       "jl_", ",", "jr_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Rn", "[", 
        RowBox[{"i", ",", "il", ",", "ir"}], "]"}], ",", 
       RowBox[{"SegmentBi2", "[", 
        RowBox[{"j", ",", "k", ",", "kat", ",", "jl", ",", "jr"}], "]"}], ",",
        "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PatchBk2", "[", 
      RowBox[{
      "i_", ",", "j_", ",", "k_", ",", "kat_", ",", "il_", ",", "ir_", ",", 
       "jl_", ",", "jr_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Rn", "[", 
        RowBox[{"i", ",", "il", ",", "ir"}], "]"}], ",", 
       RowBox[{"SegmentBj2", "[", 
        RowBox[{"j", ",", "k", ",", "kat", ",", "jl", ",", "jr"}], "]"}], ",",
        "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PatchBi2j2", "[", 
      RowBox[{
      "i_", ",", "j_", ",", "k_", ",", "kat_", ",", "il_", ",", "ir_", ",", 
       "jl_", ",", "jr_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Rn2", "[", 
        RowBox[{"i", ",", "il", ",", "ir"}], "]"}], ",", 
       RowBox[{"SegmentBi2", "[", 
        RowBox[{"j", ",", "k", ",", "kat", ",", "jl", ",", "jr"}], "]"}], ",",
        "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PatchBi2k2", "[", 
      RowBox[{
      "i_", ",", "j_", ",", "k_", ",", "kat_", ",", "il_", ",", "ir_", ",", 
       "jl_", ",", "jr_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Rn2", "[", 
        RowBox[{"i", ",", "il", ",", "ir"}], "]"}], ",", 
       RowBox[{"SegmentBj2", "[", 
        RowBox[{"j", ",", "k", ",", "kat", ",", "jl", ",", "jr"}], "]"}], ",",
        "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PatchBj2k2", "[", 
      RowBox[{
      "i_", ",", "j_", ",", "k_", ",", "kat_", ",", "il_", ",", "ir_", ",", 
       "jl_", ",", "jr_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Rn", "[", 
        RowBox[{"i", ",", "il", ",", "ir"}], "]"}], ",", 
       RowBox[{"SegmentBi2j2", "[", 
        RowBox[{"j", ",", "k", ",", "kat", ",", "jl", ",", "jr"}], "]"}], ",",
        "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PatchBi2j2k2", "[", 
      RowBox[{
      "i_", ",", "j_", ",", "k_", ",", "kat_", ",", "il_", ",", "ir_", ",", 
       "jl_", ",", "jr_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Rn2", "[", 
        RowBox[{"i", ",", "il", ",", "ir"}], "]"}], ",", 
       RowBox[{"SegmentBi2j2", "[", 
        RowBox[{"j", ",", "k", ",", "kat", ",", "jl", ",", "jr"}], "]"}], ",",
        "0"}], "]"}]}], ";"}]}]}]], "Input",
 CellLabel->
  "In[1450]:=",ExpressionUUID->"d4595fe1-2e29-499e-93ed-0c162bbad364"],

Cell[CellGroupData[{

Cell["3D", "Subsection",
 CellChangeTimes->{{3.8263849765090427`*^9, 3.826384981885791*^9}, {
   3.8307887845314417`*^9, 3.830788784669805*^9}, 
   3.850640811389015*^9},ExpressionUUID->"7db94d5e-d517-483c-9f4d-\
e5673a42af8a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"N2S2e", "[", 
    RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{
       "j", ",", "k", ",", "i", ",", "NS", ",", "0", ",", "SD", ",", "0", ",", 
        RowBox[{"DT", "-", "1"}]}], "]"}], "+", 
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{
       "k", ",", "j", ",", "i", ",", "NS", ",", "0", ",", "SD", ",", "0", ",", 
        RowBox[{"DT", "-", "1"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{
       "k", ",", "i", ",", "j", ",", "NS", ",", "0", ",", "SD", ",", "0", ",", 
        RowBox[{"DT", "-", "1"}]}], "]"}], "+", 
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{
       "i", ",", "k", ",", "j", ",", "NS", ",", "0", ",", "SD", ",", "0", ",", 
        RowBox[{"DT", "-", "1"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{
       "i", ",", "j", ",", "k", ",", "NS", ",", "0", ",", "SD", ",", "0", ",", 
        RowBox[{"DT", "-", "1"}]}], "]"}], "+", 
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{
       "j", ",", "i", ",", "k", ",", "NS", ",", "0", ",", "SD", ",", "0", ",", 
        RowBox[{"DT", "-", "1"}]}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"N2D2e", "[", 
    RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{
       "j", ",", "k", ",", "i", ",", "SD", ",", "SD", ",", "NS", ",", "0", 
        ",", 
        RowBox[{"DT", "-", "1"}]}], "]"}], "+", 
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{
       "k", ",", "j", ",", "i", ",", "SD", ",", "SD", ",", "NS", ",", "0", 
        ",", 
        RowBox[{"DT", "-", "1"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{
       "k", ",", "i", ",", "j", ",", "SD", ",", "SD", ",", "NS", ",", "0", 
        ",", 
        RowBox[{"DT", "-", "1"}]}], "]"}], "+", 
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{
       "i", ",", "k", ",", "j", ",", "SD", ",", "SD", ",", "NS", ",", "0", 
        ",", 
        RowBox[{"DT", "-", "1"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{
       "i", ",", "j", ",", "k", ",", "SD", ",", "SD", ",", "NS", ",", "0", 
        ",", 
        RowBox[{"DT", "-", "1"}]}], "]"}], "+", 
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{
       "j", ",", "i", ",", "k", ",", "SD", ",", "SD", ",", "NS", ",", "0", 
        ",", 
        RowBox[{"DT", "-", "1"}]}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"N2T2e", "[", 
    RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{"j", ",", "k", ",", "i", ",", "DT", ",", 
        RowBox[{"DT", "-", "1"}], ",", "NS", ",", 
        RowBox[{"DT", "-", "1"}], ",", "SD"}], "]"}], "+", 
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{"k", ",", "j", ",", "i", ",", "DT", ",", 
        RowBox[{"DT", "-", "1"}], ",", "NS", ",", 
        RowBox[{"DT", "-", "1"}], ",", "SD"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{"k", ",", "i", ",", "j", ",", "DT", ",", 
        RowBox[{"DT", "-", "1"}], ",", "NS", ",", 
        RowBox[{"DT", "-", "1"}], ",", "SD"}], "]"}], "+", 
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{"i", ",", "k", ",", "j", ",", "DT", ",", 
        RowBox[{"DT", "-", "1"}], ",", "NS", ",", 
        RowBox[{"DT", "-", "1"}], ",", "SD"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{"i", ",", "j", ",", "k", ",", "DT", ",", 
        RowBox[{"DT", "-", "1"}], ",", "NS", ",", 
        RowBox[{"DT", "-", "1"}], ",", "SD"}], "]"}], "+", 
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{"j", ",", "i", ",", "k", ",", "DT", ",", 
        RowBox[{"DT", "-", "1"}], ",", "NS", ",", 
        RowBox[{"DT", "-", "1"}], ",", "SD"}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S2D2e", "[", 
    RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", "\[IndentingNewLine]", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{
       "j", ",", "k", ",", "i", ",", "SD", ",", "NS", ",", "CAP", ",", "0", 
        ",", "DT"}], "]"}], "+", 
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{
       "k", ",", "j", ",", "i", ",", "SD", ",", "NS", ",", "CAP", ",", "0", 
        ",", "DT"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{
       "k", ",", "i", ",", "j", ",", "SD", ",", "NS", ",", "CAP", ",", "0", 
        ",", "DT"}], "]"}], "+", 
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{
       "i", ",", "k", ",", "j", ",", "SD", ",", "NS", ",", "CAP", ",", "0", 
        ",", "DT"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{
       "i", ",", "j", ",", "k", ",", "SD", ",", "NS", ",", "CAP", ",", "0", 
        ",", "DT"}], "]"}], "+", 
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{
       "j", ",", "i", ",", "k", ",", "SD", ",", "NS", ",", "CAP", ",", "0", 
        ",", "DT"}], "]"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S2T2e", "[", 
    RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{
       "j", ",", "k", ",", "i", ",", "DT", ",", "NS", ",", "CAP", ",", "DT", 
        ",", "SD"}], "]"}], "+", 
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{
       "k", ",", "j", ",", "i", ",", "DT", ",", "NS", ",", "CAP", ",", "DT", 
        ",", "SD"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{
       "k", ",", "i", ",", "j", ",", "DT", ",", "NS", ",", "CAP", ",", "DT", 
        ",", "SD"}], "]"}], "+", 
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{
       "i", ",", "k", ",", "j", ",", "DT", ",", "NS", ",", "CAP", ",", "DT", 
        ",", "SD"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{
       "i", ",", "j", ",", "k", ",", "DT", ",", "NS", ",", "CAP", ",", "DT", 
        ",", "SD"}], "]"}], "+", 
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{
       "j", ",", "i", ",", "k", ",", "DT", ",", "NS", ",", "CAP", ",", "DT", 
        ",", "SD"}], "]"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"D2T2e", "[", 
    RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PatchBi2j2k2", "[", 
      RowBox[{
      "j", ",", "k", ",", "i", ",", "DT", ",", "SD", ",", "CAP", ",", "SD", 
       ",", "CAP"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"PatchBi2j2k2", "[", 
      RowBox[{
      "k", ",", "i", ",", "j", ",", "DT", ",", "SD", ",", "CAP", ",", "SD", 
       ",", "CAP"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"PatchBi2j2k2", "[", 
      RowBox[{
      "i", ",", "j", ",", "k", ",", "DT", ",", "SD", ",", "CAP", ",", "SD", 
       ",", "CAP"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S2CAP2e", "[", 
   RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PatchBi2j2k2", "[", 
      RowBox[{
      "j", ",", "k", ",", "i", ",", "CAP", ",", "0", ",", "DT", ",", "0", ",",
        "SD"}], "]"}], "+", 
     RowBox[{"PatchBi2j2k2", "[", 
      RowBox[{
      "k", ",", "j", ",", "i", ",", "CAP", ",", "0", ",", "DT", ",", "0", ",",
        "SD"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PatchBi2j2k2", "[", 
      RowBox[{
      "k", ",", "i", ",", "j", ",", "CAP", ",", "0", ",", "DT", ",", "0", ",",
        "SD"}], "]"}], "+", 
     RowBox[{"PatchBi2j2k2", "[", 
      RowBox[{
      "i", ",", "k", ",", "j", ",", "CAP", ",", "0", ",", "DT", ",", "0", ",",
        "SD"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PatchBi2j2k2", "[", 
      RowBox[{
      "i", ",", "j", ",", "k", ",", "CAP", ",", "0", ",", "DT", ",", "0", ",",
        "SD"}], "]"}], "+", 
     RowBox[{"PatchBi2j2k2", "[", 
      RowBox[{
      "j", ",", "i", ",", "k", ",", "CAP", ",", "0", ",", "DT", ",", "0", ",",
        "SD"}], "]"}]}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D2CAP2e", "[", 
   RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PatchBi2j2k2", "[", 
      RowBox[{
      "j", ",", "k", ",", "i", ",", "CAP", ",", "SD", ",", "CAP", ",", "0", 
       ",", "DT"}], "]"}], "+", 
     RowBox[{"PatchBi2j2k2", "[", 
      RowBox[{
      "k", ",", "j", ",", "i", ",", "CAP", ",", "SD", ",", "CAP", ",", "0", 
       ",", "DT"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PatchBi2j2k2", "[", 
      RowBox[{
      "k", ",", "i", ",", "j", ",", "CAP", ",", "SD", ",", "CAP", ",", "0", 
       ",", "DT"}], "]"}], "+", 
     RowBox[{"PatchBi2j2k2", "[", 
      RowBox[{
      "i", ",", "k", ",", "j", ",", "CAP", ",", "SD", ",", "CAP", ",", "0", 
       ",", "DT"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PatchBi2j2k2", "[", 
      RowBox[{
      "i", ",", "j", ",", "k", ",", "CAP", ",", "SD", ",", "CAP", ",", "0", 
       ",", "DT"}], "]"}], "+", 
     RowBox[{"PatchBi2j2k2", "[", 
      RowBox[{
      "j", ",", "i", ",", "k", ",", "CAP", ",", "SD", ",", "CAP", ",", "0", 
       ",", "DT"}], "]"}]}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T2CAP2e", "[", 
   RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PatchBi2j2k2", "[", 
     RowBox[{
     "j", ",", "k", ",", "i", ",", "CAP", ",", "DT", ",", "CAP", ",", "DT", 
      ",", "CAP"}], "]"}], 
    RowBox[{"(*", 
     RowBox[{"+", 
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{
       "k", ",", "j", ",", "i", ",", "CAP", ",", "DT", ",", "CAP", ",", "DT", 
        ",", "CAP"}], "]"}]}], "*)"}], ",", "\[IndentingNewLine]", 
    RowBox[{"PatchBi2j2k2", "[", 
     RowBox[{
     "k", ",", "i", ",", "j", ",", "CAP", ",", "DT", ",", "CAP", ",", "DT", 
      ",", "CAP"}], "]"}], 
    RowBox[{"(*", 
     RowBox[{"+", 
      RowBox[{"PatchBi2j2k2", "[", 
       RowBox[{
       "i", ",", "k", ",", "j", ",", "CAP", ",", "0", ",", "DT", ",", "CAP", 
        ",", "DT", ",", "CAP"}], "]"}]}], "*)"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"PatchBi2j2k2", "[", 
     RowBox[{
     "i", ",", "j", ",", "k", ",", "CAP", ",", "DT", ",", "CAP", ",", "DT", 
      ",", "CAP"}], "]"}]}], 
   RowBox[{"(*", 
    RowBox[{"+", 
     RowBox[{"PatchBi2j2k2", "[", 
      RowBox[{
      "j", ",", "i", ",", "k", ",", "CAP", ",", "0", ",", "DT", ",", "CAP", 
       ",", "DT", ",", "CAP"}], "]"}]}], "*)"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.82638500214642*^9, 3.826385062360046*^9}, {
   3.8263864058044786`*^9, 3.826386478991754*^9}, {3.826386553341134*^9, 
   3.8263866020237207`*^9}, {3.826386655629451*^9, 3.826386693059658*^9}, {
   3.826386730094975*^9, 3.826386735096327*^9}, {3.826386808720869*^9, 
   3.826386829169223*^9}, {3.826386933375983*^9, 3.826386977881083*^9}, {
   3.826387162843794*^9, 3.826387208596092*^9}, {3.826387439516529*^9, 
   3.826387448178918*^9}, {3.826387505602274*^9, 3.826387513807922*^9}, {
   3.8263875725622797`*^9, 3.8263876060284033`*^9}, {3.826387777992792*^9, 
   3.826387786084278*^9}, 3.8263884342543287`*^9, {3.8263884684874*^9, 
   3.826388474731399*^9}, {3.826390073158098*^9, 3.8263901180340633`*^9}, {
   3.826390158540797*^9, 3.82639027042456*^9}, {3.826390361609939*^9, 
   3.826390362036268*^9}, {3.826390392904559*^9, 3.826390407156692*^9}, {
   3.8263904588798656`*^9, 3.826390481624264*^9}, {3.826390532138651*^9, 
   3.826390575329561*^9}, {3.826390628075109*^9, 3.826390731408166*^9}, {
   3.826390770699237*^9, 3.82639078929784*^9}, {3.8263908264904127`*^9, 
   3.8263908783514757`*^9}, {3.8263909277183647`*^9, 3.826390938425824*^9}, {
   3.826390999990623*^9, 3.826391008635997*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"6063fa6a-57df-4b37-b481-c971e54a10a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"plot", " ", "b"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"Raster3D", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"val2int", "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"n2s", ",", 
               RowBox[{"N2S2e", "[", 
                RowBox[{
                 RowBox[{"i", "-", "n2"}], ",", 
                 RowBox[{"j", "-", "n2"}], ",", 
                 RowBox[{"k", "-", "n2"}]}], "]"}], ",", "0"}], "]"}], "+", 
             RowBox[{"If", "[", 
              RowBox[{"n2d", ",", 
               RowBox[{"N2D2e", "[", 
                RowBox[{
                 RowBox[{"i", "-", "n2"}], ",", 
                 RowBox[{"j", "-", "n2"}], ",", 
                 RowBox[{"k", "-", "n2"}]}], "]"}], ",", "0"}], "]"}], "+", 
             RowBox[{"If", "[", 
              RowBox[{"n2t", ",", 
               RowBox[{"N2T2e", "[", 
                RowBox[{
                 RowBox[{"i", "-", "n2"}], ",", 
                 RowBox[{"j", "-", "n2"}], ",", 
                 RowBox[{"k", "-", "n2"}]}], "]"}], ",", "0"}], "]"}]}], 
            ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "0", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "0", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"ColorFunction", "\[Rule]", "color"}]}], "]"}], ",", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"k", ",", "j", ",", "i"}], "}"}]}], ",", 
      RowBox[{"Ticks", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"ticks", ",", "ticks", ",", "ticks"}], "}"}]}], ",", 
      RowBox[{"PlotRangePadding", "\[Rule]", "0.5"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
      RowBox[{"Axes", "->", "True"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"n2s", ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"n2d", ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"n2t", ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[531]:=",ExpressionUUID->"53de0c72-6e31-48c5-b10f-8565ebf4ef21"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"plot", " ", "c"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"Raster3D", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"val2int", "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"s2d", ",", 
               RowBox[{"S2D2e", "[", 
                RowBox[{
                 RowBox[{"i", "-", "n2"}], ",", 
                 RowBox[{"j", "-", "n2"}], ",", 
                 RowBox[{"k", "-", "n2"}]}], "]"}], ",", "0"}], "]"}], "+", 
             RowBox[{"If", "[", 
              RowBox[{"s2t", ",", 
               RowBox[{"S2T2e", "[", 
                RowBox[{
                 RowBox[{"i", "-", "n2"}], ",", 
                 RowBox[{"j", "-", "n2"}], ",", 
                 RowBox[{"k", "-", "n2"}]}], "]"}], ",", "0"}], "]"}], "+", 
             RowBox[{"If", "[", 
              RowBox[{"d2t", ",", 
               RowBox[{"D2T2e", "[", 
                RowBox[{
                 RowBox[{"i", "-", "n2"}], ",", 
                 RowBox[{"j", "-", "n2"}], ",", 
                 RowBox[{"k", "-", "n2"}]}], "]"}], ",", "0"}], "]"}]}], 
            ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "0", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "0", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"ColorFunction", "\[Rule]", "color"}]}], "]"}], ",", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"k", ",", "j", ",", "i"}], "}"}]}], ",", 
      RowBox[{"Ticks", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"ticks", ",", "ticks", ",", "ticks"}], "}"}]}], ",", 
      RowBox[{"PlotRangePadding", "\[Rule]", "0.5"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
      RowBox[{"Axes", "->", "True"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"s2d", ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s2t", ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d2t", ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.826385170275443*^9, 3.826385182768621*^9}, {
  3.826385296094371*^9, 3.826385389124454*^9}, {3.8263854935054693`*^9, 
  3.8263855023573713`*^9}, {3.8263855332917557`*^9, 3.82638553358246*^9}, {
  3.826385642083436*^9, 3.8263857302501793`*^9}, {3.82638581697296*^9, 
  3.826385829247188*^9}, {3.8263887341460238`*^9, 3.8263887379886093`*^9}},
 CellLabel->
  "In[532]:=",ExpressionUUID->"6ec179bf-ee3e-4072-b03d-aac8b06987b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"all", " ", "regions"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"Raster3D", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"val2int", "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"n2s", ",", 
               RowBox[{"N2S2e", "[", 
                RowBox[{
                 RowBox[{"i", "-", "n2"}], ",", 
                 RowBox[{"j", "-", "n2"}], ",", 
                 RowBox[{"k", "-", "n2"}]}], "]"}], ",", "0"}], "]"}], 
             "\[IndentingNewLine]", "+", 
             RowBox[{"If", "[", 
              RowBox[{"n2d", ",", 
               RowBox[{"N2D2e", "[", 
                RowBox[{
                 RowBox[{"i", "-", "n2"}], ",", 
                 RowBox[{"j", "-", "n2"}], ",", 
                 RowBox[{"k", "-", "n2"}]}], "]"}], ",", "0"}], "]"}], 
             "\[IndentingNewLine]", "+", 
             RowBox[{"If", "[", 
              RowBox[{"n2t", ",", 
               RowBox[{"N2T2e", "[", 
                RowBox[{
                 RowBox[{"i", "-", "n2"}], ",", 
                 RowBox[{"j", "-", "n2"}], ",", 
                 RowBox[{"k", "-", "n2"}]}], "]"}], ",", "0"}], "]"}], 
             "\[IndentingNewLine]", "+", 
             RowBox[{"If", "[", 
              RowBox[{"s2d", ",", 
               RowBox[{"S2D2e", "[", 
                RowBox[{
                 RowBox[{"i", "-", "n2"}], ",", 
                 RowBox[{"j", "-", "n2"}], ",", 
                 RowBox[{"k", "-", "n2"}]}], "]"}], ",", "0"}], "]"}], 
             "\[IndentingNewLine]", "+", 
             RowBox[{"If", "[", 
              RowBox[{"s2t", ",", 
               RowBox[{"S2T2e", "[", 
                RowBox[{
                 RowBox[{"i", "-", "n2"}], ",", 
                 RowBox[{"j", "-", "n2"}], ",", 
                 RowBox[{"k", "-", "n2"}]}], "]"}], ",", "0"}], "]"}], 
             "\[IndentingNewLine]", "+", 
             RowBox[{"If", "[", 
              RowBox[{"d2t", ",", 
               RowBox[{"D2T2e", "[", 
                RowBox[{
                 RowBox[{"i", "-", "n2"}], ",", 
                 RowBox[{"j", "-", "n2"}], ",", 
                 RowBox[{"k", "-", "n2"}]}], "]"}], ",", "0"}], "]"}], 
             "\[IndentingNewLine]", "+", 
             RowBox[{"If", "[", 
              RowBox[{"s2cap", ",", 
               RowBox[{"S2CAP2e", "[", 
                RowBox[{
                 RowBox[{"i", "-", "n2"}], ",", 
                 RowBox[{"j", "-", "n2"}], ",", 
                 RowBox[{"k", "-", "n2"}]}], "]"}], ",", "0"}], "]"}], 
             "\[IndentingNewLine]", "+", 
             RowBox[{"If", "[", 
              RowBox[{"d2cap", ",", 
               RowBox[{"D2CAP2e", "[", 
                RowBox[{
                 RowBox[{"i", "-", "n2"}], ",", 
                 RowBox[{"j", "-", "n2"}], ",", 
                 RowBox[{"k", "-", "n2"}]}], "]"}], ",", "0"}], "]"}], 
             "\[IndentingNewLine]", "+", 
             RowBox[{"If", "[", 
              RowBox[{"t2cap", ",", 
               RowBox[{"T2CAP2e", "[", 
                RowBox[{
                 RowBox[{"i", "-", "n2"}], ",", 
                 RowBox[{"j", "-", "n2"}], ",", 
                 RowBox[{"k", "-", "n2"}]}], "]"}], ",", "0"}], "]"}]}], 
            ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "0", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "0", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"ColorFunction", "\[Rule]", "color"}]}], "]"}], ",", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"k", ",", "j", ",", "i"}], "}"}]}], ",", 
      RowBox[{"Ticks", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"ticks", ",", "ticks", ",", "ticks"}], "}"}]}], ",", 
      RowBox[{"PlotRangePadding", "\[Rule]", "0.5"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
      RowBox[{"Axes", "->", "True"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"n2s", ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"n2d", ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"n2t", ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s2d", ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s2t", ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d2t", ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s2cap", ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d2cap", ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"t2cap", ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[137]:=",ExpressionUUID->"5cc2bf26-13d2-470d-8ba4-b14aa32cd7b3"]
}, Closed]],

Cell[CellGroupData[{

Cell["2D", "Subsection",
 CellChangeTimes->{{3.8263849829845448`*^9, 3.826384984954225*^9}, {
  3.8307887788590393`*^9, 3.830788779732254*^9}, {3.8506408136003532`*^9, 
  3.8506408140355873`*^9}},ExpressionUUID->"446ebe99-985c-4e9a-9775-\
0cd2f63769ff"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"N2Se", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"SegmentBi2j2", "[", 
      RowBox[{"j", ",", "i", ",", "NS", ",", "0", ",", "SD"}], "]"}], ",", 
     RowBox[{"SegmentBi2j2", "[", 
      RowBox[{"i", ",", "j", ",", "NS", ",", "0", ",", "SD"}], "]"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"S2De", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"SegmentBi2j2", "[", 
       RowBox[{"j", ",", "i", ",", "SD", ",", "NS", ",", "CAP"}], "]"}], ",", 
      
      RowBox[{"SegmentBi2j2", "[", 
       RowBox[{"i", ",", "j", ",", "SD", ",", "NS", ",", "CAP"}], "]"}]}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S2DeSYM", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"SegmentB", "[", 
       RowBox[{"j", ",", "i", ",", "SD", ",", "NS", ",", "CAP"}], "]"}], "-", 
      
      RowBox[{"SegmentB", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "j"}], "-", "1"}], ",", 
        RowBox[{
         RowBox[{"-", "i"}], "-", "1"}], ",", "SD", ",", "NS", ",", "CAP"}], 
       "]"}]}], ",", 
     RowBox[{
      RowBox[{"SegmentB", "[", 
       RowBox[{"i", ",", "j", ",", "SD", ",", "NS", ",", "CAP"}], "]"}], "-", 
      
      RowBox[{"SegmentB", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "i"}], "-", "1"}], ",", 
        RowBox[{
         RowBox[{"-", "j"}], "-", "1"}], ",", "SD", ",", "NS", ",", "CAP"}], 
       "]"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"S2DeASYM", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"SegmentB", "[", 
         RowBox[{"j", ",", 
          RowBox[{
           RowBox[{"-", "i"}], "-", "1"}], ",", "SD", ",", "NS", ",", "CAP"}],
          "]"}]}], "+", 
       RowBox[{"SegmentB", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "j"}], "-", "1"}], ",", "i", ",", "SD", ",", "NS", ",",
          "CAP"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"SegmentB", "[", 
         RowBox[{"i", ",", 
          RowBox[{
           RowBox[{"-", "j"}], "-", "1"}], ",", "SD", ",", "NS", ",", "CAP"}],
          "]"}]}], "+", 
       RowBox[{"SegmentB", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "i"}], "-", "1"}], ",", "j", ",", "SD", ",", "NS", ",",
          "CAP"}], "]"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"N2De", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"SegmentBi2j2", "[", 
       RowBox[{"j", ",", "i", ",", "SD", ",", "SD", ",", "NS"}], "]"}], ",", 
      RowBox[{"SegmentBi2j2", "[", 
       RowBox[{"i", ",", "j", ",", "SD", ",", "SD", ",", "NS"}], "]"}]}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"N2DeSYM", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"SegmentB", "[", 
       RowBox[{"j", ",", "i", ",", "SD", ",", "SD", ",", "NS"}], "]"}], "-", 
      RowBox[{"SegmentB", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "j"}], "-", "1"}], ",", 
        RowBox[{
         RowBox[{"-", "i"}], "-", "1"}], ",", "SD", ",", "SD", ",", "NS"}], 
       "]"}]}], ",", 
     RowBox[{
      RowBox[{"SegmentB", "[", 
       RowBox[{"i", ",", "j", ",", "SD", ",", "SD", ",", "NS"}], "]"}], "-", 
      RowBox[{"SegmentB", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "i"}], "-", "1"}], ",", 
        RowBox[{
         RowBox[{"-", "j"}], "-", "1"}], ",", "SD", ",", "SD", ",", "NS"}], 
       "]"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"N2DeASYM", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"SegmentB", "[", 
         RowBox[{"j", ",", 
          RowBox[{
           RowBox[{"-", "i"}], "-", "1"}], ",", "SD", ",", "SD", ",", "NS"}], 
         "]"}]}], "+", 
       RowBox[{"SegmentB", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "j"}], "-", "1"}], ",", "i", ",", "SD", ",", "SD", ",",
          "NS"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"SegmentB", "[", 
         RowBox[{"i", ",", 
          RowBox[{
           RowBox[{"-", "j"}], "-", "1"}], ",", "SD", ",", "SD", ",", "NS"}], 
         "]"}]}], "+", 
       RowBox[{"SegmentB", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "i"}], "-", "1"}], ",", "j", ",", "SD", ",", "SD", ",",
          "NS"}], "]"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S2CAPe", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"SegmentBi2j2", "[", 
      RowBox[{"j", ",", "i", ",", "CAP", ",", "0", ",", "SD"}], "]"}], ",", 
     RowBox[{"SegmentBi2j2", "[", 
      RowBox[{"i", ",", "j", ",", "CAP", ",", "0", ",", "SD"}], "]"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"D2CAPe", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"SegmentBi2j2", "[", 
      RowBox[{"j", ",", "i", ",", "CAP", ",", "SD", ",", "CAP"}], "]"}], ",", 
     
     RowBox[{"SegmentBi2j2", "[", 
      RowBox[{"i", ",", "j", ",", "CAP", ",", "SD", ",", "CAP"}], "]"}]}], 
    "}"}]}], ";"}]}], "Input",
 CellLabel->
  "In[1466]:=",ExpressionUUID->"84cf9b3a-9bdd-4d7d-a0ec-fc7fef228717"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ArrayPlot", "[", 
     RowBox[{
      RowBox[{"Reverse", "@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"val2int", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{"s2d", ",", 
              RowBox[{"S2De", "[", 
               RowBox[{
                RowBox[{"i", "-", "n2"}], ",", 
                RowBox[{"j", "-", "n2"}]}], "]"}], ",", "0"}], "]"}], "+", 
            RowBox[{"If", "[", 
             RowBox[{"n2s", ",", 
              RowBox[{"N2Se", "[", 
               RowBox[{
                RowBox[{"i", "-", "n2"}], ",", 
                RowBox[{"j", "-", "n2"}]}], "]"}], ",", "0"}], "]"}], "+", 
            RowBox[{"If", "[", 
             RowBox[{"n2d", ",", 
              RowBox[{"N2De", "[", 
               RowBox[{
                RowBox[{"i", "-", "n2"}], ",", 
                RowBox[{"j", "-", "n2"}]}], "]"}], ",", "0"}], "]"}], "+", 
            RowBox[{"If", "[", 
             RowBox[{"s2cap", ",", 
              RowBox[{"S2CAPe", "[", 
               RowBox[{
                RowBox[{"i", "-", "n2"}], ",", 
                RowBox[{"j", "-", "n2"}]}], "]"}], ",", "0"}], "]"}], "+", 
            RowBox[{"If", "[", 
             RowBox[{"d2cap", ",", 
              RowBox[{"D2CAPe", "[", 
               RowBox[{
                RowBox[{"i", "-", "n2"}], ",", 
                RowBox[{"j", "-", "n2"}]}], "]"}], ",", "0"}], "]"}]}], 
           ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
      RowBox[{"ColorFunction", "\[Rule]", "color"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<y [au]\>\"", ",", "\"\<j [index]\>\""}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<i [index]\>\"", ",", "\"\<x [au]\>\""}], "}"}]}], 
        "}"}]}], ",", 
      RowBox[{"FrameTicks", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ticksI", ",", "ticksP"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ticksP", ",", "ticksI"}], "}"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"DataRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"rng2", ",", "rng2"}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"DataReversed", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
      RowBox[{"GridLines", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n2", "-", "0.5"}], ")"}], " ", "realRatio"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n2", "-", "0.5"}], ")"}], " ", "realRatio"}], "}"}]}], 
        "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotRangePadding", "\[Rule]", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]", 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n2s", ",", "False"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n2d", ",", "False"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s2d", ",", "True"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s2cap", ",", "False"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"d2cap", ",", "False"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.850641850500236*^9, 3.850641920954418*^9}, {
  3.850642687298942*^9, 3.8506426912877913`*^9}, {3.85064272719881*^9, 
  3.850642789598134*^9}, {3.850645159593761*^9, 3.850645193812398*^9}, {
  3.8506452765928907`*^9, 3.850645383838106*^9}, {3.85064572593757*^9, 
  3.850645734546691*^9}, {3.850645785722866*^9, 3.850645797419496*^9}, {
  3.850645849189127*^9, 3.850645922763172*^9}, {3.850646140338807*^9, 
  3.850646219148847*^9}},
 CellLabel->
  "In[1552]:=",ExpressionUUID->"ab2db51e-19ab-4648-ae1b-bfd2b61d9bb3"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`d2cap$$ = False, $CellContext`n2d$$ = 
    False, $CellContext`n2s$$ = False, $CellContext`s2cap$$ = 
    False, $CellContext`s2d$$ = True, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`n2s$$], False}, {True, False}}, {{
       Hold[$CellContext`n2d$$], False}, {True, False}}, {{
       Hold[$CellContext`s2d$$], True}, {True, False}}, {{
       Hold[$CellContext`s2cap$$], False}, {True, False}}, {{
       Hold[$CellContext`d2cap$$], False}, {True, False}}}, Typeset`size$$ = {
    576., {275., 279.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`d2cap$$ = False, $CellContext`n2d$$ = 
        False, $CellContext`n2s$$ = False, $CellContext`s2cap$$ = 
        False, $CellContext`s2d$$ = True}, "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ArrayPlot[
        Reverse[
         Table[
          $CellContext`val2int[If[$CellContext`s2d$$, 
             $CellContext`S2De[$CellContext`i - $CellContext`n2, \
$CellContext`j - $CellContext`n2], 0] + If[$CellContext`n2s$$, 
             $CellContext`N2Se[$CellContext`i - $CellContext`n2, \
$CellContext`j - $CellContext`n2], 0] + If[$CellContext`n2d$$, 
             $CellContext`N2De[$CellContext`i - $CellContext`n2, \
$CellContext`j - $CellContext`n2], 0] + If[$CellContext`s2cap$$, 
             $CellContext`S2CAPe[$CellContext`i - $CellContext`n2, \
$CellContext`j - $CellContext`n2], 0] + If[$CellContext`d2cap$$, 
             $CellContext`D2CAPe[$CellContext`i - $CellContext`n2, \
$CellContext`j - $CellContext`n2], 0]], {$CellContext`i, 0, $CellContext`n - 
           1}, {$CellContext`j, 0, $CellContext`n - 1}]], 
        ColorFunction -> $CellContext`color, ColorFunctionScaling -> False, 
        FrameLabel -> {{"y [au]", "j [index]"}, {"i [index]", "x [au]"}}, 
        FrameTicks -> {{$CellContext`ticksI, $CellContext`ticksP}, \
{$CellContext`ticksP, $CellContext`ticksI}}, 
        DataRange -> {$CellContext`rng2, $CellContext`rng2}, DataReversed -> 
        True, GridLines -> {{($CellContext`n2 - 
            0.5) $CellContext`realRatio}, {($CellContext`n2 - 
            0.5) $CellContext`realRatio}}, PlotRangePadding -> 0, ImageSize -> 
        Large], "Specifications" :> {{{$CellContext`n2s$$, False}, {
         True, False}}, {{$CellContext`n2d$$, False}, {
         True, False}}, {{$CellContext`s2d$$, True}, {
         True, False}}, {{$CellContext`s2cap$$, False}, {
         True, False}}, {{$CellContext`d2cap$$, False}, {True, False}}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{618., {361., 366.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.850640895667925*^9, 3.850640910280828*^9}, {
   3.850640951715365*^9, 3.850640958337525*^9}, {3.8506411871338387`*^9, 
   3.850641205778277*^9}, {3.8506414305264997`*^9, 3.850641435286491*^9}, {
   3.850641827140354*^9, 3.850641857331086*^9}, {3.8506418983704023`*^9, 
   3.850641921251421*^9}, {3.850642663308709*^9, 3.850642702752582*^9}, 
   3.850642739695869*^9, 3.850642791756435*^9, {3.850643949808029*^9, 
   3.850643955329111*^9}, {3.850644046029752*^9, 3.8506440503547792`*^9}, {
   3.850644123561845*^9, 3.850644127584738*^9}, {3.850645165027012*^9, 
   3.850645194257451*^9}, {3.850645296716386*^9, 3.8506453357831793`*^9}, {
   3.850645366269638*^9, 3.8506453843445053`*^9}, 3.850645735098135*^9, {
   3.850645786384974*^9, 3.8506457979129267`*^9}, {3.850645850360422*^9, 
   3.8506458679624977`*^9}, {3.850645918274764*^9, 3.85064593799772*^9}, {
   3.85064596858154*^9, 3.850645998958412*^9}, {3.8506461679403152`*^9, 
   3.850646219607799*^9}},
 CellLabel->
  "Out[1552]=",ExpressionUUID->"a082e2b0-6658-4f9a-91ed-184479b03cbe"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[" 1D", "Subsection",
 CellChangeTimes->{
  3.85064082541971*^9},ExpressionUUID->"41dfbe5e-db1d-4dd2-b559-858614cdbcff"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"PointB2", "[", 
     RowBox[{
      RowBox[{"i", "-", "10"}], ",", "5"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "20"}], "}"}]}], "]"}], "]"}]], "Input",
 CellLabel->
  "In[552]:=",ExpressionUUID->"53dbba95-3265-4ea6-94fa-22776e09e713"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      NCache[
       Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6], 
     LineBox[CompressedData["
1:eJxTTMoPSmViYGAQBWIQDQEf7BlQgQMqlwONL4DGF0HjS0D5H/ZDaBk0eQU0
vhIaXwWNr4bG10Dja6HxddD4ejD3QP1pgCZviMY3QuMbo/FN0PimcD4AepkN
lw==
      "]]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 21.}, {-1., 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellLabel->
  "Out[552]=",ExpressionUUID->"460f454f-bd66-42ef-b6c7-c67e39271cda"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Other", "Subsection",
 CellChangeTimes->{{3.850640841655357*^9, 
  3.850640842213155*^9}},ExpressionUUID->"72d6ce43-7efe-48d1-9880-\
15d4562f9cb1"],

Cell[CellGroupData[{

Cell["ManhatanSphere", "Subsubsection",ExpressionUUID->"3144ab08-033a-45ee-a45d-9adbb89d6672"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Cube3e", "[", 
   RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PatchBi2j2k2", "[", 
     RowBox[{
     "j", ",", "k", ",", "i", ",", "CAP", ",", "0", ",", "CAP", ",", "0", ",",
       "CAP"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"PatchBi2j2k2", "[", 
     RowBox[{
     "k", ",", "i", ",", "j", ",", "CAP", ",", "0", ",", "CAP", ",", "0", ",",
       "CAP"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"PatchBi2j2k2", "[", 
     RowBox[{
     "i", ",", "j", ",", "k", ",", "CAP", ",", "0", ",", "CAP", ",", "0", ",",
       "CAP"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{"Raster3D", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"val2int", "@", 
        RowBox[{"Cube3e", "[", 
         RowBox[{
          RowBox[{"i", "-", "n2"}], ",", 
          RowBox[{"j", "-", "n2"}], ",", 
          RowBox[{"k", "-", "n2"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", "color"}]}], "]"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"k", ",", "j", ",", "i"}], "}"}]}], ",", 
   RowBox[{"Ticks", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"ticks", ",", "ticks", ",", "ticks"}], "}"}]}], ",", 
   RowBox[{"PlotRangePadding", "\[Rule]", "0.5"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
   RowBox[{"Axes", "->", "True"}]}], "]"}]}], "Input",
 CellLabel->
  "In[447]:=",ExpressionUUID->"ea8635c8-ec84-4377-964f-6bdcfed2b10a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Cube2e", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SegmentBi2j2", "[", 
      RowBox[{"j", ",", "i", ",", 
       RowBox[{"CAP", "/", "2"}], ",", "0", ",", 
       RowBox[{"CAP", "/", "2"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"SegmentBi2j2", "[", 
      RowBox[{"i", ",", "j", ",", 
       RowBox[{"CAP", "/", "2"}], ",", "0", ",", 
       RowBox[{"CAP", "/", "2"}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixPlot", "[", 
  RowBox[{
   RowBox[{"Reverse", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"val2int", "@", 
       RowBox[{"Cube2e", "[", 
        RowBox[{
         RowBox[{"i", "-", "n2"}], ",", 
         RowBox[{"j", "-", "n2"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        RowBox[{"n", "-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "0", ",", 
        RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", "color"}], ",", 
   RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"j", ",", "y"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "i"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"FrameTicks", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ticks", ",", "ticks2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ticks2", ",", "ticks"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"DataRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"rng2", ",", "rng2"}], "}"}]}], ",", 
   RowBox[{"DataReversed", "\[Rule]", "True"}], ",", 
   RowBox[{"GridLines", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n2", "-", "0.5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"n2", "-", "0.5"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotRangePadding", "\[Rule]", "0"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], "Input",
 CellLabel->
  "In[619]:=",ExpressionUUID->"8f07ce67-58ec-469d-8bdb-a4e4940c13ca"]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
WindowSize->{960, 1147},
WindowMargins->{{Automatic, -280}, {900, Automatic}},
DynamicEvaluationTimeout->20,
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (December 2, 2021)",
StyleDefinitions->"Science.nb",
ExpressionUUID->"2e48e5ed-cc88-4162-bc10-614967a8f458"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 156, 3, 71, "Section",ExpressionUUID->"672cf219-ec5f-4bcf-89ca-4b3929bd5614"],
Cell[739, 27, 373, 11, 52, "EquationNumbered",ExpressionUUID->"ff1be03c-e57e-49d6-b955-ad70e9bbb8c7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1149, 43, 158, 3, 71, "Section",ExpressionUUID->"b69eea4b-04c8-42c6-b723-d616c42e9c82"],
Cell[1310, 48, 3092, 86, 233, "Input",ExpressionUUID->"a1e06307-bcd1-4f29-af6d-86b8155fad90"],
Cell[4405, 136, 1663, 38, 156, "Input",ExpressionUUID->"52b55510-899c-4218-b6ef-b5425140935c"],
Cell[6071, 176, 3623, 90, 268, "Input",ExpressionUUID->"a60ca76a-69d3-41c7-ac67-cf6980809b10"],
Cell[9697, 268, 7859, 216, 437, "Input",ExpressionUUID->"d4595fe1-2e29-499e-93ed-0c162bbad364"],
Cell[CellGroupData[{
Cell[17581, 488, 227, 4, 47, "Subsection",ExpressionUUID->"7db94d5e-d517-483c-9f4d-e5673a42af8a"],
Cell[17811, 494, 12531, 313, 660, "Input",ExpressionUUID->"6063fa6a-57df-4b37-b481-c971e54a10a2"],
Cell[30345, 809, 2646, 69, 188, "Input",ExpressionUUID->"53de0c72-6e31-48c5-b10f-8565ebf4ef21"],
Cell[32994, 880, 3010, 74, 188, "Input",ExpressionUUID->"6ec179bf-ee3e-4072-b03d-aac8b06987b0"],
Cell[36007, 956, 5551, 143, 298, "Input",ExpressionUUID->"5cc2bf26-13d2-470d-8ba4-b14aa32cd7b3"]
}, Closed]],
Cell[CellGroupData[{
Cell[41595, 1104, 253, 4, 47, "Subsection",ExpressionUUID->"446ebe99-985c-4e9a-9775-0cd2f63769ff"],
Cell[41851, 1110, 5888, 179, 318, "Input",ExpressionUUID->"84cf9b3a-9bdd-4d7d-a0ec-fc7fef228717"],
Cell[CellGroupData[{
Cell[47764, 1293, 4885, 128, 351, "Input",ExpressionUUID->"ab2db51e-19ab-4648-ae1b-bfd2b61d9bb3"],
Cell[52652, 1423, 4625, 80, 741, "Output",ExpressionUUID->"a082e2b0-6658-4f9a-91ed-184479b03cbe"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[57326, 1509, 124, 2, 47, "Subsection",ExpressionUUID->"41dfbe5e-db1d-4dd2-b559-858614cdbcff"],
Cell[CellGroupData[{
Cell[57475, 1515, 356, 10, 32, "Input",ExpressionUUID->"53dbba95-3265-4ea6-94fa-22776e09e713"],
Cell[57834, 1527, 1397, 41, 221, "Output",ExpressionUUID->"460f454f-bd66-42ef-b6c7-c67e39271cda"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[59280, 1574, 153, 3, 47, "Subsection",ExpressionUUID->"72d6ce43-7efe-48d1-9880-15d4562f9cb1"],
Cell[CellGroupData[{
Cell[59458, 1581, 94, 0, 44, "Subsubsection",ExpressionUUID->"3144ab08-033a-45ee-a45d-9adbb89d6672"],
Cell[59555, 1583, 1913, 50, 144, "Input",ExpressionUUID->"ea8635c8-ec84-4377-964f-6bdcfed2b10a"],
Cell[61471, 1635, 2195, 62, 142, "Input",ExpressionUUID->"8f07ce67-58ec-469d-8bdb-a4e4940c13ca"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}
]
*)

