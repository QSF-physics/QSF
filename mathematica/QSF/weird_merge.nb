(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     67667,       1762]
NotebookOptionsPosition[     55307,       1553]
NotebookOutlinePosition[     61099,       1673]
CellTagsIndexPosition[     61056,       1670]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"<<", 
  "\"\</Users/ranza/Projects/Quantum/QSF-examples/QSF/plotting/common/wf.wls\>\
\""}]], "Input",
 CellLabel->
  "In[386]:=",ExpressionUUID->"fc30adb5-f356-4a89-98af-34b8532380ad"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"hd", ",", "data"}], "}"}], "=", 
   RowBox[{
   "WFLoad", "[", 
    "\"\</Users/ranza/Projects/Quantum/QSF-examples/examples/argon-2e/Results/\
es/nm_3100/fwhm_cycles_3.965000/phase_0.000000/momenta_repX.psi2\>\"", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"WFNorm", "[", 
  RowBox[{"hd", ",", 
   RowBox[{
    RowBox[{"Abs", "[", "data", "]"}], "^", "2"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataP", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Times", "@@", 
      RowBox[{"Dimensions", "[", "data", "]"}]}], ")"}], 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"(", 
         RowBox[{"Times", "@@", 
          RowBox[{"hd", "[", "\"\<dxs\>\"", "]"}]}], ")"}], 
        RowBox[{"2", "\[Pi]"}]], 
       RowBox[{"Fourier", "[", "data", "]"}]}], "]"}], "^", "2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"hd", ",", "data"}], "}"}], "=", 
   RowBox[{"WFLoad", "[", 
    RowBox[{
    "\"\</Users/ranza/Projects/Quantum/QSF-examples/examples/argon-2e/Results/\
es/nm_3100/fwhm_cycles_3.965000/phase_0.000000/momenta_repP.psi2\>\"", ",", 
     RowBox[{"Probability", "->", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"WFNorm", "[", 
  RowBox[{"hd", ",", "data"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"WFNorm", "[", 
  RowBox[{"hd", ",", "dataP"}], "]"}]}], "Input",
 CellLabel->"In[41]:=",ExpressionUUID->"71237251-7199-4833-bd13-1dd58f08a8a7"],

Cell[BoxData["0.0011308990712684708`"], "Output",
 CellLabel->"Out[42]=",ExpressionUUID->"ea479790-6bef-4f0f-97e4-c7d23367ad25"],

Cell[BoxData["0.0011308990712684721`"], "Output",
 CellLabel->"Out[45]=",ExpressionUUID->"e89f87e5-91f6-4e21-82e5-ca9f744bdd0a"],

Cell[BoxData["0.001130899071268472`"], "Output",
 CellLabel->"Out[46]=",ExpressionUUID->"4a6e905f-7098-4892-8d66-79e0149258ee"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",ExpressionUUID->"35226616-dbd9-44ec-8f82-1a1b817c99bc"],

Cell[BoxData["\<\"/Users/ranza/Projects/Quantum/QSF-examples/examples/argon-\
2e/Results\"\>"], "Output",
 CellLabel->
  "Out[153]=",ExpressionUUID->"25f59059-8b01-47c4-a4ca-cef4798a91a4"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",ExpressionUUID->"c6bcf3ba-3130-4a7f-a6f9-b8de73ce5269"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"StringSplit", "[", 
  RowBox[{"\"\<sada@a\>\"", ",", "\"\<@\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"StringSplit", "[", 
  RowBox[{"\"\<@\>\"", ",", "\"\<@\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"main", "=", 
  RowBox[{"StringTrim", "[", 
   RowBox[{"\"\<sada121a\>\"", ",", 
    RowBox[{"StringSplit", "[", 
     RowBox[{"\"\<sada@a\>\"", ",", "\"\<@\>\""}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"StringReplace", "[", 
  RowBox[{"\"\<sada121a\>\"", ",", 
   RowBox[{"main", "->", "\"\<\>\""}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"StringTrim", "[", 
  RowBox[{"\"\<121\>\"", ",", 
   RowBox[{"StringSplit", "[", 
    RowBox[{"\"\<sada@a\>\"", ",", "\"\<@\>\""}], "]"}]}], "]"}]}], "Input",
 CellLabel->"In[11]:=",ExpressionUUID->"8cd1cd22-1d99-4dbf-a0f5-33ae6594e39b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"sada\"\>", ",", "\<\"a\"\>"}], "}"}]], "Output",
 CellLabel->"Out[11]=",ExpressionUUID->"6b9f60a3-95c9-46a0-afb6-4a4e04c037b3"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellLabel->"Out[12]=",ExpressionUUID->"b7d0f4e2-8098-41de-b0bd-86f0b5e90829"],

Cell[BoxData["\<\"121\"\>"], "Output",
 CellLabel->"Out[13]=",ExpressionUUID->"6d2ae8f5-c30a-4c84-829c-511a3266b4ab"],

Cell[BoxData["\<\"sadaa\"\>"], "Output",
 CellLabel->"Out[14]=",ExpressionUUID->"e0bd2d5b-edda-49a2-88cf-45e3c13c95c5"],

Cell[BoxData["\<\"121\"\>"], "Output",
 CellLabel->"Out[15]=",ExpressionUUID->"3b5f1a44-1d2b-47eb-bcc9-dc51ac22909a"]
}, Open  ]],

Cell[BoxData["StringDrop"], "Input",ExpressionUUID->"944ff032-276f-4096-872b-87059ec1972a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "SetDirectory", "[", 
   "\"\</Users/ranza/Projects/Quantum/QSF-examples/examples/argon-2e/Results\>\
\"", "]"}], ";"}]], "Input",
 CellLabel->"In[41]:=",ExpressionUUID->"e91c5e31-fae7-424a-add7-75adb91b70e8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "inp", "=", "\"\<*/nm_3100/fwhm_cycles_*/phase_*/momenta_repP.psi3\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"inps", "=", 
    RowBox[{"FileNameSplit", "[", "inp", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"groupIDs", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Position", "[", 
     RowBox[{"inps", ",", 
      RowBox[{"n_", "/;", 
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"n", ",", "\"\<@\>\""}], "]"}]}], ",", 
      RowBox[{"Heads", "->", "False"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"avgIDs", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Position", "[", 
      RowBox[{"inps", ",", 
       RowBox[{"n_", "/;", 
        RowBox[{"StringContainsQ", "[", 
         RowBox[{"n", ",", "\"\<*\>\""}], "]"}]}], ",", 
       RowBox[{"Heads", "->", "False"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"groups", "=", 
   RowBox[{"GroupBy", "[", 
    RowBox[{
     RowBox[{"FileNames", "[", "inp", "]"}], ",", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FileNameSplit", "[", "#", "]"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "groupIDs"}], "}"}]}], "]"}], "&"}]}], " ", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"keys", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"StringDelete", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{"\"\<0\>\"", ".."}], "~~", "EndOfLine"}]}], "]"}], "&"}], "/@", 
       RowBox[{"(", 
        RowBox[{"StringTrim", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{"#", ",", "\"\<@\>\""}], "]"}], "&"}], "/@", 
           RowBox[{"inps", "[", 
            RowBox[{"[", "groupIDs", "]"}], "]"}]}]}], "]"}], ")"}]}], "&"}], 
     "/@", 
     RowBox[{"Keys", "[", "groups", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outs", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FileNameJoin", "@", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{
         RowBox[{"FileNameSplit", "[", "#", "]"}], ",", 
         RowBox[{"AssociationMap", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"inps", "[", 
               RowBox[{"[", "#", "]"}], "]"}], ",", 
              RowBox[{"\"\<*\>\"", "->", "\"\<AVG\>\""}]}], "]"}], "&"}], ",",
            " ", "avgIDs"}], "]"}]}], "]"}]}], "&"}], ",", 
     RowBox[{"Values", "[", "groups", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Length", "[", "groupIDs", "]"}], "+", "1"}], "}"}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outs", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"First", ",", "outs", ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "groupIDs", "]"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"groupInput", "=", 
   RowBox[{"AssociationThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"keys", "\[Transpose]"}], ",", 
        RowBox[{"{", "outs", "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"Values", "[", "groups", "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KeyValueMap", "[", 
   RowBox[{",", "groupInput"}], "]"}], ";"}]}], "Input",
 CellLabel->
  "In[252]:=",ExpressionUUID->"dbb721f6-afc4-46a9-9169-88d3a7840ca4"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"{", "}"}], "\[Rule]", 
   RowBox[{"{", 
    RowBox[{"\<\"eb/nm_3100/fwhm_cycles_13.540000/phase_0.000000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"eb/nm_3100/fwhm_cycles_13.540000/phase_0.250000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"eb/nm_3100/fwhm_cycles_13.540000/phase_0.500000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"eb/nm_3100/fwhm_cycles_3.965000/phase_0.000000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"eb/nm_3100/fwhm_cycles_3.965000/phase_0.250000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"eb/nm_3100/fwhm_cycles_3.965000/phase_0.500000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"eb/nm_3100/fwhm_cycles_6.576000/phase_0.000000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"eb/nm_3100/fwhm_cycles_6.576000/phase_0.250000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"eb/nm_3100/fwhm_cycles_6.576000/phase_0.500000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"es/nm_3100/fwhm_cycles_13.540000/phase_0.000000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"es/nm_3100/fwhm_cycles_13.540000/phase_0.250000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"es/nm_3100/fwhm_cycles_13.540000/phase_0.500000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"es/nm_3100/fwhm_cycles_3.965000/phase_0.000000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"es/nm_3100/fwhm_cycles_3.965000/phase_0.250000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"es/nm_3100/fwhm_cycles_3.965000/phase_0.500000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"es/nm_3100/fwhm_cycles_6.576000/phase_0.000000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"es/nm_3100/fwhm_cycles_6.576000/phase_0.250000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"es/nm_3100/fwhm_cycles_6.576000/phase_0.500000/momenta_repP.\
psi3\"\>"}], "}"}]}], "\[RightAssociation]"}]], "Output",
 CellLabel->
  "Out[256]=",ExpressionUUID->"ddb63452-e1bc-4ba3-b19b-805e9dddd469"],

Cell[BoxData[
 TemplateBox[{
  "FileNameSplit", "fstr", 
   "\"File specification \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"\\\\\\\"eb/nm_3100/fwhm_cycles_13.540000/phase_0.000000/momenta_\
repP.psi3\\\\\\\"\\\", \\\",\\\", \
\\\"\\\\\\\"eb/nm_3100/fwhm_cycles_13.540000/phase_0.250000/momenta_repP.psi3\
\\\\\\\"\\\", \\\",\\\", \
\\\"\\\\\\\"eb/nm_3100/fwhm_cycles_13.540000/phase_0.500000/momenta_repP.psi3\
\\\\\\\"\\\", \\\",\\\", \
\\\"\\\\\\\"eb/nm_3100/fwhm_cycles_3.965000/phase_0.000000/momenta_repP.psi3\\\
\\\\\"\\\", \\\",\\\", \
\\\"\\\\\\\"eb/nm_3100/fwhm_cycles_3.965000/phase_0.250000/momenta_repP.psi3\\\
\\\\\"\\\", \\\",\\\", \
\\\"\\\\\\\"eb/nm_3100/fwhm_cycles_3.965000/phase_0.500000/momenta_repP.psi3\\\
\\\\\"\\\", \\\",\\\", \
\\\"\\\\\\\"eb/nm_3100/fwhm_cycles_6.576000/phase_0.000000/momenta_repP.psi3\\\
\\\\\"\\\", \\\",\\\", \
\\\"\\\\\\\"eb/nm_3100/fwhm_cycles_6.576000/phase_0.250000/momenta_repP.psi3\\\
\\\\\"\\\", \\\",\\\", \
\\\"\\\\\\\"eb/nm_3100/fwhm_cycles_6.576000/phase_0.500000/momenta_repP.psi3\\\
\\\\\"\\\", \\\",\\\", \
\\\"\\\\\\\"es/nm_3100/fwhm_cycles_13.540000/phase_0.000000/momenta_repP.psi3\
\\\\\\\"\\\", \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"8\\\", \\\"\
\[RightSkeleton]\\\"}]}], \\\"}\\\"}]\\) is not a string of one or more \
characters.\"", 2, 258, 46, 17711970250266712106, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellLabel->
  "During evaluation of \
In[252]:=",ExpressionUUID->"a16cf9e6-327a-47b3-ad9b-9aa8f2e8cb69"],

Cell[BoxData["\<\"AVG\"\>"], "Output",
 CellLabel->
  "Out[259]=",ExpressionUUID->"11761035-4465-47e5-b494-ea2fa127a249"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{"\<\"AVG\"\>", "\[Rule]", 
   RowBox[{"{", 
    RowBox[{"\<\"eb/nm_3100/fwhm_cycles_13.540000/phase_0.000000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"eb/nm_3100/fwhm_cycles_13.540000/phase_0.250000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"eb/nm_3100/fwhm_cycles_13.540000/phase_0.500000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"eb/nm_3100/fwhm_cycles_3.965000/phase_0.000000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"eb/nm_3100/fwhm_cycles_3.965000/phase_0.250000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"eb/nm_3100/fwhm_cycles_3.965000/phase_0.500000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"eb/nm_3100/fwhm_cycles_6.576000/phase_0.000000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"eb/nm_3100/fwhm_cycles_6.576000/phase_0.250000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"eb/nm_3100/fwhm_cycles_6.576000/phase_0.500000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"es/nm_3100/fwhm_cycles_13.540000/phase_0.000000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"es/nm_3100/fwhm_cycles_13.540000/phase_0.250000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"es/nm_3100/fwhm_cycles_13.540000/phase_0.500000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"es/nm_3100/fwhm_cycles_3.965000/phase_0.000000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"es/nm_3100/fwhm_cycles_3.965000/phase_0.250000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"es/nm_3100/fwhm_cycles_3.965000/phase_0.500000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"es/nm_3100/fwhm_cycles_6.576000/phase_0.000000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"es/nm_3100/fwhm_cycles_6.576000/phase_0.250000/momenta_repP.\
psi3\"\>", 
     ",", "\<\"es/nm_3100/fwhm_cycles_6.576000/phase_0.500000/momenta_repP.\
psi3\"\>"}], "}"}]}], "\[RightAssociation]"}]], "Output",
 CellLabel->
  "Out[260]=",ExpressionUUID->"1f318627-aeff-4c69-b509-a453fb60514d"]
}, Open  ]],

Cell[BoxData["\[AliasDelimiter]"], "Input",ExpressionUUID->"e976654a-f134-4368-89e5-c3f2f5ef3ef8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"names", "=", 
   RowBox[{
   "FileNames", "[", 
    "\"\</Users/ranza/Projects/Quantum/QSF-examples/examples/argon-2e/Results/\
es/nm_3100/fwhm_cycles_3.965000/phase_0.000000/momenta_repX.psi*\>\"", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Multicolumn", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"hd", ",", "data"}], "}"}], "=", 
        RowBox[{"WFLoad", "[", "#", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"hd", "[", "\"\<ns\>\"", "]"}], "=", 
        RowBox[{
         RowBox[{"hd", "[", "\"\<ns\>\"", "]"}], "/", "8"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{";;", ";;", "8"}], ",", 
           RowBox[{";;", ";;", "8"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mask", "=", 
        RowBox[{"WFInvMask", "[", 
         RowBox[{"hd", ",", "0.5"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"data0", "=", "data"}], ";", "\[IndentingNewLine]", 
       RowBox[{"hd0", "=", "hd"}], ";", "\[IndentingNewLine]", 
       RowBox[{"pscale", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Times", "@@", 
           RowBox[{"hd", "[", "\"\<dxs\>\"", "]"}]}], ")"}], " ", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Times", "@@", 
             RowBox[{"Dimensions", "[", "data", "]"}]}], ")"}], "/", 
           RowBox[{"Power", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", " ", "\[Pi]"}], ")"}], ",", 
             RowBox[{"hd", "[", "\"\<dim\>\"", "]"}]}], " ", "]"}]}], " ", 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"hd", "[", "\"\<rep\>\"", "]"}], "==", "2"}], ",", "data", 
          ",", 
          RowBox[{
           RowBox[{
            RowBox[{"hd", "[", "\"\<rep\>\"", "]"}], "=", "2"}], ";", 
           RowBox[{
            RowBox[{"Fourier", "[", 
             RowBox[{
              RowBox[{"Transpose", "[", "data", "]"}], " ", 
              RowBox[{"WFShiftTrick", "[", "hd", "]"}], " ", "mask"}], "]"}], 
            " ", "pscale"}]}]}], " ", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Multicolumn", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ArrayPlot", "[", 
            RowBox[{
             RowBox[{"Log", "[", 
              RowBox[{
               RowBox[{"Abs", "[", "data0", "]"}], "^", "2"}], "]"}], ",", 
             RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"X", ",", "Y"}], "}"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"WFPlot", "[", 
              RowBox[{"hd0", ",", "data0", ",", 
               RowBox[{"PlotLabel", "->", 
                RowBox[{"ToString", "[", 
                 RowBox[{"hd", "[", "\"\<bounded\>\"", "]"}], "]"}]}], ",", 
               RowBox[{"PlotRange", "->", "Full"}]}], "]"}], ","}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"WFPlot", "[", 
            RowBox[{"hd0", ",", "mask", ",", 
             RowBox[{"PlotLabel", "->", 
              RowBox[{"ToString", "[", 
               RowBox[{"hd", "[", "\"\<bounded\>\"", "]"}], "]"}]}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"X", ",", "Y"}], "}"}]}], ",", 
             RowBox[{"PlotRange", "->", "Full"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"WFPlot", "[", 
            RowBox[{"hd", ",", 
             RowBox[{
              RowBox[{"Abs", "[", "data", "]"}], "^", "2"}], ",", 
             RowBox[{"BlurRadius", "->", "0.1"}], ",", 
             RowBox[{"PlotLabel", "->", 
              RowBox[{"Last", "[", 
               RowBox[{"FileNameSplit", "[", "#", "]"}], "]"}]}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"X", ",", "Y"}], "}"}]}], ",", 
             RowBox[{"PlotRange", "->", "Full"}]}], "]"}]}], "}"}], ",", 
         "1"}], "]"}]}], "\[IndentingNewLine]", ")"}], "&"}], "/@", "names"}],
    ",", "4"}], "]"}]}], "Input",
 CellLabel->
  "In[397]:=",ExpressionUUID->"97aa1c20-4c2f-4af9-bf33-9ab69ad80752"],

Cell[BoxData[""], "Input",ExpressionUUID->"31a816a4-26d8-45b8-8807-d38e0c2a1eaf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"names", "=", 
     RowBox[{
     "FileNames", "[", 
      "\"\</Users/ranza/Projects/Quantum/QSF-examples/examples/argon-2e/\
Results/es/nm_3100/fwhm_cycles_3.965000/phase_0.000000/momenta_repX.psi*\>\"",
       "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"names", "=", 
     RowBox[{
     "FileNames", "[", 
      "\"\</Users/ranza/Projects/Quantum/QSF-examples/examples/argon-2e/\
Results/es/test/testing/snapshot_19_step1519_repX*\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Multicolumn", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"hd", ",", "data"}], "}"}], "=", 
          RowBox[{"WFLoad", "[", "#", "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"hd", "[", "\"\<ns\>\"", "]"}], "=", 
            RowBox[{
             RowBox[{"hd", "[", "\"\<ns\>\"", "]"}], "/", "8"}]}], ";"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"data", "=", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{";;", ";;", "8"}], ",", 
               RowBox[{";;", ";;", "8"}]}], "]"}], "]"}]}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"mask", "=", 
          RowBox[{"WFInvMask", "[", 
           RowBox[{"hd", ",", "0.6"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"data0", "=", "data"}], ";", "\[IndentingNewLine]", 
         RowBox[{"hd0", "=", "hd"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Echo", "[", 
          RowBox[{
           RowBox[{"WFNorm", "[", 
            RowBox[{"hd", ",", 
             RowBox[{
              RowBox[{"Abs", "[", "data", "]"}], "^", "2"}]}], "]"}], ",", 
           "#"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"pscale", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Times", "@@", 
             RowBox[{"hd", "[", "\"\<dxs\>\"", "]"}]}], ")"}], " ", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Times", "@@", 
               RowBox[{"hd", "[", "\"\<ns\>\"", "]"}]}], ")"}], "/", 
             RowBox[{"Power", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", " ", "\[Pi]"}], ")"}], ",", 
               RowBox[{"hd", "[", "\"\<dim\>\"", "]"}]}], " ", "]"}]}], " ", 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"data", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"hd", "[", "\"\<rep\>\"", "]"}], "==", "2"}], ",", 
            "data", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"hd", "[", "\"\<rep\>\"", "]"}], "=", "2"}], ";", 
             RowBox[{
              RowBox[{"Fourier", "[", 
               RowBox[{"data", " ", 
                RowBox[{"WFShiftTrick", "[", "hd", "]"}], " ", "mask"}], 
               "]"}], "pscale"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Echo", "[", 
          RowBox[{
           RowBox[{"WFNorm", "[", 
            RowBox[{"hd", ",", 
             RowBox[{
              RowBox[{"Abs", "[", "data", "]"}], "^", "2"}]}], "]"}], ",", 
           "#"}], "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        ")"}], "&"}], "/@", "names"}], ",", "4"}], "]"}]}]}]], "Input",
 CellLabel->
  "In[384]:=",ExpressionUUID->"3fa5c69b-90e6-452a-9207-8805b7ae0b21"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox["\<\"/Users/ranza/Projects/Quantum/QSF-examples/examples/argon-2e/\
Results/es/test/testing/snapshot_19_step1519_repX.psi0\"\>",
   "EchoLabel"], "  ", "1.9572604077945273`*^-12"}]], "Echo",ExpressionUUID->\
"fbf04b2a-0e1d-478e-b7a3-cde50950ad34"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"/Users/ranza/Projects/Quantum/QSF-examples/examples/argon-2e/\
Results/es/test/testing/snapshot_19_step1519_repX.psi0\"\>",
   "EchoLabel"], "  ", "1.7889647714228672`*^-14"}]], "Echo",ExpressionUUID->\
"4139d819-7776-416d-8e05-d80637affe67"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"/Users/ranza/Projects/Quantum/QSF-examples/examples/argon-2e/\
Results/es/test/testing/snapshot_19_step1519_repX.psi1\"\>",
   "EchoLabel"], "  ", "1.4193546979206556`*^-6"}]], "Echo",ExpressionUUID->\
"61c49d5f-ecb1-486a-a317-7a1017336e46"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"/Users/ranza/Projects/Quantum/QSF-examples/examples/argon-2e/\
Results/es/test/testing/snapshot_19_step1519_repX.psi1\"\>",
   "EchoLabel"], "  ", "4.003120601371643`*^-7"}]], "Echo",ExpressionUUID->\
"2106d3af-0a1f-442c-a414-46fbd0798b38"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"/Users/ranza/Projects/Quantum/QSF-examples/examples/argon-2e/\
Results/es/test/testing/snapshot_19_step1519_repX.psi2\"\>",
   "EchoLabel"], "  ", "1.419354697920643`*^-6"}]], "Echo",ExpressionUUID->\
"5c6b80b8-bc79-4e92-a70d-c5a4e3dab5af"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"/Users/ranza/Projects/Quantum/QSF-examples/examples/argon-2e/\
Results/es/test/testing/snapshot_19_step1519_repX.psi2\"\>",
   "EchoLabel"], "  ", "4.0031206013716515`*^-7"}]], "Echo",ExpressionUUID->\
"5277820d-5f1a-4eb6-8644-26980f216f5c"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"/Users/ranza/Projects/Quantum/QSF-examples/examples/argon-2e/\
Results/es/test/testing/snapshot_19_step1519_repX.psi3\"\>",
   "EchoLabel"], "  ", "1.0001245765527014`"}]], "Echo",ExpressionUUID->\
"b4934d03-426c-402a-aa6b-112470ae27a0"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"/Users/ranza/Projects/Quantum/QSF-examples/examples/argon-2e/\
Results/es/test/testing/snapshot_19_step1519_repX.psi3\"\>",
   "EchoLabel"], "  ", "0.`"}]], "Echo",ExpressionUUID->"436acaef-f50b-4dbb-\
b628-b581cc44c7d6"]
}, Open  ]],

Cell[BoxData[
 TagBox[GridBox[{
    {"", "", "", ""}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellLabel->
  "Out[385]=",ExpressionUUID->"680551f4-8b8a-4b62-8def-2c18642da5ee"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"names", "=", 
     RowBox[{
     "FileNames", "[", 
      "\"\</Users/ranza/Projects/Quantum/QSF-examples/examples/argon-2e/\
Results/es/test/testing/snapshot_19_step1519_repX.psi*\>\"", "]"}]}], ";"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"names", "=", 
     RowBox[{
     "FileNames", "[", 
      "\"\</Users/ranza/Projects/Quantum/QSF-examples/examples/argon-2e/\
Results/es/test/testing/snapshot_19_step1519_rep*\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Multicolumn", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"hd", ",", "data"}], "}"}], "=", 
          RowBox[{"WFLoad", "[", "#", "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"hd", "[", "\"\<ns\>\"", "]"}], "=", 
            RowBox[{
             RowBox[{"hd", "[", "\"\<ns\>\"", "]"}], "/", "8"}]}], ";"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"data", "=", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{";;", ";;", "8"}], ",", 
               RowBox[{";;", ";;", "8"}]}], "]"}], "]"}]}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"mask", "=", 
          RowBox[{"WFInvMask", "[", 
           RowBox[{"hd", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"pscale", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Times", "@@", 
             RowBox[{"hd", "[", "\"\<dxs\>\"", "]"}]}], ")"}], " ", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Times", "@@", 
               RowBox[{"Dimensions", "[", "data", "]"}]}], ")"}], "/", 
             RowBox[{"Power", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", " ", "\[Pi]"}], ")"}], ",", 
               RowBox[{"hd", "[", "\"\<dim\>\"", "]"}]}], " ", "]"}]}], " ", 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"data", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"hd", "[", "\"\<rep\>\"", "]"}], "==", "2"}], ",", 
            "data", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"hd", "[", "\"\<rep\>\"", "]"}], "=", "2"}], ";", 
             RowBox[{
              RowBox[{"Fourier", "[", 
               RowBox[{
                RowBox[{"Transpose", "[", "data", "]"}], " ", 
                RowBox[{"WFShiftTrick", "[", "hd", "]"}], " ", "mask"}], 
               "]"}], " ", "pscale"}]}]}], " ", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Multicolumn", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"WFPlot", "[", 
              RowBox[{"hd", ",", "mask", ",", 
               RowBox[{"PlotLabel", "->", 
                RowBox[{"ToString", "[", 
                 RowBox[{"hd", "[", "\"\<bounded\>\"", "]"}], "]"}]}], ",", 
               RowBox[{"PlotRange", "->", "Full"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"WFPlot", "[", 
              RowBox[{"hd", ",", 
               RowBox[{
                RowBox[{"Abs", "[", "data", "]"}], "^", "2"}], ",", 
               RowBox[{"BlurRadius", "->", "0.1"}], ",", 
               RowBox[{"PlotLabel", "->", 
                RowBox[{
                 RowBox[{"Last", "[", 
                  RowBox[{"FileNameSplit", "[", "#", "]"}], "]"}], 
                 RowBox[{"ToString", "[", 
                  RowBox[{"hd", "[", "\"\<bounded\>\"", "]"}], "]"}]}]}], ",", 
               RowBox[{"PlotRange", "->", "Full"}]}], "]"}]}], "}"}], ",", 
           "1"}], "]"}]}], "\[IndentingNewLine]", ")"}], "&"}], "/@", 
      "names"}], ",", "4"}], "]"}]}]}]], "Input",
 CellLabel->
  "In[275]:=",ExpressionUUID->"bbb7c1af-716f-4190-a466-6711a6930c36"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"names", "=", 
   RowBox[{
   "FileNames", "[", 
    "\"\</Users/ranza/Projects/Quantum/QSF-examples/examples/argon-2e/Results/\
es/test/testing/snapshot_19_step1519_rep*\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"filterFun", "[", "paths_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"hd", ",", "res", ",", "bt"}], "}"}], ",", 
     RowBox[{
      RowBox[{"res", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"paths", ",", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", 
            RowBox[{"\"\<repP.psi\>\"", "|", "\"\<repX.psi\>\""}]}], "]"}], 
          "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bt", "=", 
       RowBox[{"Total", "[", 
        RowBox[{"hd", "[", "\"\<bounded\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Select", "[", 
       RowBox[{"res", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"hd", "=", 
            RowBox[{"WFHeader", "[", "#", "]"}]}], ";", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"hd", "[", "\"\<rep\>\"", "]"}], "==", "2"}], "&&", 
              RowBox[{"bt", "==", "0"}]}], ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"hd", "[", "\"\<rep\>\"", "]"}], "==", "1"}], "&&", 
              RowBox[{"bt", ">", "0"}]}], ")"}]}]}], ")"}], "&"}]}], 
       "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"names", "=", 
  RowBox[{"filterFun", "[", "names", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hd0", "=", "None"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pscale", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Times", "@@", 
      RowBox[{"hd", "[", "\"\<dxs\>\"", "]"}]}], ")"}], " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Times", "@@", 
        RowBox[{"Dimensions", "[", "data", "]"}]}], ")"}], "/", 
      RowBox[{"Power", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", " ", "\[Pi]"}], ")"}], ",", 
        RowBox[{"hd", "[", "\"\<dim\>\"", "]"}]}], " ", "]"}]}], " ", 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"all", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"hd", ",", "data"}], "}"}], "=", 
         RowBox[{"WFLoad", "[", "#", "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"hd", "[", "\"\<rep\>\"", "]"}], "==", "2"}], ",", 
          RowBox[{
           RowBox[{"hd0", "=", "hd"}], ";", "data"}], ",", 
          RowBox[{
           RowBox[{"Fourier", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", "data", "]"}], " ", 
             RowBox[{"WFShiftTrick", "[", "hd", "]"}], " ", 
             RowBox[{"WFInvMask", "[", "hd", "]"}]}], "]"}], " ", 
           "pscale"}]}], " ", "]"}]}], ")"}], "&"}], ",", "names"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"all", "=", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{
      RowBox[{"Abs", "[", "all", "]"}], "^", "2"}], "]"}], "/", 
    RowBox[{"Length", "[", "all", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WFPlot", "[", 
   RowBox[{"hd0", ",", "all", ",", 
    RowBox[{"BlurRadius", "->", "0.1"}], ",", 
    RowBox[{"QuarterMerge", "->", "None"}], ",", 
    RowBox[{"PlotRange", "->", "Full"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"all", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"hd", ",", "data"}], "}"}], "=", 
         RowBox[{"WFLoad", "[", "#", "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"hd", "[", "\"\<rep\>\"", "]"}], "==", "2"}], ",", 
          RowBox[{
           RowBox[{"hd0", "=", "hd"}], ";", "data"}], ",", 
          RowBox[{
           RowBox[{"Fourier", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", "data", "]"}], " ", 
             RowBox[{"WFShiftTrick", "[", "hd", "]"}], " ", 
             RowBox[{"WFInvMask", "[", 
              RowBox[{"hd", ",", "1"}], "]"}]}], "]"}], " ", "pscale"}]}], 
         "]"}]}], ")"}], "&"}], ",", "names"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"all", "=", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{
      RowBox[{"Abs", "[", "all", "]"}], "^", "2"}], "]"}], "/", 
    RowBox[{"Length", "[", "all", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"WFPlot", "[", 
  RowBox[{"hd0", ",", "all", ",", 
   RowBox[{"BlurRadius", "->", "0.1"}], ",", 
   RowBox[{"QuarterMerge", "->", "None"}], ",", 
   RowBox[{"PlotRange", "->", "Full"}]}], "]"}]}], "Input",
 CellLabel->
  "In[264]:=",ExpressionUUID->"1430645c-8ee1-4ba3-a2e7-99efd4441f81"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"/Users/ranza/Projects/Quantum/QSF-examples/examples/argon-2e/\
Results/es/test/testing/snapshot_19_step1519_repP.psi3\"\>", 
   ",", "\<\"/Users/ranza/Projects/Quantum/QSF-examples/examples/argon-2e/\
Results/es/test/testing/snapshot_19_step1519_repX.psi0\"\>", 
   ",", "\<\"/Users/ranza/Projects/Quantum/QSF-examples/examples/argon-2e/\
Results/es/test/testing/snapshot_19_step1519_repX.psi1\"\>", 
   ",", "\<\"/Users/ranza/Projects/Quantum/QSF-examples/examples/argon-2e/\
Results/es/test/testing/snapshot_19_step1519_repX.psi2\"\>"}], 
  "}"}]], "Output",
 CellLabel->
  "Out[266]=",ExpressionUUID->"70a82965-16f2-4e96-9356-f0007dd08c65"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"names", "=", 
   RowBox[{
   "FileNames", "[", 
    "\"\</Users/ranza/Projects/Quantum/QSF-examples/examples/argon-2e/Results/\
es/nm_3100/fwhm_cycles_6.576000/phase_0.000000/momenta_rep*\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"filterFun", "[", "paths_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"hd", ",", "res", ",", "bt"}], "}"}], ",", 
     RowBox[{
      RowBox[{"res", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"paths", ",", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", 
            RowBox[{"\"\<repP.psi\>\"", "|", "\"\<repX.psi\>\""}]}], "]"}], 
          "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bt", "=", 
       RowBox[{"Total", "[", 
        RowBox[{"hd", "[", "\"\<bounded\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Select", "[", 
       RowBox[{"res", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"hd", "=", 
            RowBox[{"WFHeader", "[", "#", "]"}]}], ";", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"hd", "[", "\"\<rep\>\"", "]"}], "==", "2"}], "&&", 
              RowBox[{"bt", "==", "0"}]}], ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"hd", "[", "\"\<rep\>\"", "]"}], "==", "1"}], "&&", 
              RowBox[{"bt", ">", "0"}]}], ")"}]}]}], ")"}], "&"}]}], 
       "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"names", "=", 
   RowBox[{"filterFun", "[", "names", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hd0", "=", "None"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pscale", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Times", "@@", 
      RowBox[{"hd", "[", "\"\<dxs\>\"", "]"}]}], ")"}], " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Times", "@@", 
        RowBox[{"Dimensions", "[", "data", "]"}]}], ")"}], "/", 
      RowBox[{"Power", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", " ", "\[Pi]"}], ")"}], ",", 
        RowBox[{"hd", "[", "\"\<dim\>\"", "]"}]}], " ", "]"}]}], " ", 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"all", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"hd", ",", "data"}], "}"}], "=", 
         RowBox[{"WFLoad", "[", "#", "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"hd", "[", "\"\<rep\>\"", "]"}], "==", "2"}], ",", 
          RowBox[{
           RowBox[{"hd0", "=", "hd"}], ";", "data"}], ",", 
          RowBox[{
           RowBox[{"Fourier", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", "data", "]"}], " ", 
             RowBox[{"WFShiftTrick", "[", "hd", "]"}], " ", 
             RowBox[{"WFInvMask", "[", 
              RowBox[{"hd", ",", "4"}], "]"}]}], "]"}], " ", "pscale"}]}], 
         " ", "]"}]}], ")"}], "&"}], ",", "names"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"all", "=", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{
      RowBox[{"Abs", "[", "all", "]"}], "^", "2"}], "]"}], "/", 
    RowBox[{"Length", "[", "all", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WFPlot", "[", 
   RowBox[{"hd0", ",", "all", ",", 
    RowBox[{"BlurRadius", "->", "0.1"}], ",", 
    RowBox[{"QuarterMerge", "->", "None"}], ",", 
    RowBox[{"PlotRange", "->", "Full"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"all", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"hd", ",", "data"}], "}"}], "=", 
         RowBox[{"WFLoad", "[", "#", "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"hd", "[", "\"\<rep\>\"", "]"}], "==", "2"}], ",", 
          RowBox[{
           RowBox[{"hd0", "=", "hd"}], ";", "data"}], ",", 
          RowBox[{
           RowBox[{"Fourier", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", "data", "]"}], " ", 
             RowBox[{"WFShiftTrick", "[", "hd", "]"}], " ", 
             RowBox[{"WFInvMask", "[", 
              RowBox[{"hd", ",", "2"}], "]"}]}], "]"}], " ", "pscale"}]}], 
         "]"}]}], ")"}], "&"}], ",", "names"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"all", "=", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{
      RowBox[{"Abs", "[", "all", "]"}], "^", "2"}], "]"}], "/", 
    RowBox[{"Length", "[", "all", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"WFPlot", "[", 
  RowBox[{"hd0", ",", "all", ",", 
   RowBox[{"BlurRadius", "->", "0.1"}], ",", 
   RowBox[{"QuarterMerge", "->", "None"}], ",", 
   RowBox[{"PlotRange", "->", "Full"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",ExpressionUUID->"419c8120-2d78-4e18-\
a4d3-fb3ff642a526"],

Cell[BoxData["$Aborted"], "Output",
 CellLabel->
  "Out[195]=",ExpressionUUID->"dbd92f43-119b-4e29-90d1-b99ef104d4f0"],

Cell[BoxData[
 TemplateBox[{
  "ArrayPlot", "mat", 
   "\"Argument \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"2.4921309717319514`*^-14\\\", \\\",\\\", \
\\\"2.5418741123616378`*^-14\\\", \\\",\\\", \
\\\"2.5915607743319316`*^-14\\\", \\\",\\\", \
\\\"2.6408002786807688`*^-14\\\", \\\",\\\", \\\"2.689485402807644`*^-14\\\", \
\\\",\\\", \\\"2.7373824794968387`*^-14\\\", \\\",\\\", \
\\\"2.7845287435479668`*^-14\\\", \\\",\\\", \
\\\"2.8305475605854808`*^-14\\\", \\\",\\\", \\\"2.875414958504336`*^-14\\\", \
\\\",\\\", \\\"2.918894688276309`*^-14\\\", \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"4086\\\", \\\"\[RightSkeleton]\\\"}]}], \
\\\"}\\\"}]\\) at position \\!\\(\\*RowBox[{\\\"1\\\"}]\\) is not a list of \
lists.\"", 2, 197, 17, 17711448214811821683, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellLabel->
  "During evaluation of \
In[187]:=",ExpressionUUID->"f14843ee-bb1f-4663-9f4c-04732a4eb5fc"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"hd", ",", "data"}], "}"}], "=", 
   RowBox[{
   "WFLoad", "[", 
    "\"\</Users/ranza/Projects/Quantum/QSF-examples/examples/argon-2e/Results/\
es/nm_3100/fwhm_cycles_6.576000/phase_0.000000/momenta_repP.psi3\>\"", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"WFPlot", "[", 
  RowBox[{"hd", ",", 
   RowBox[{
    RowBox[{"Abs", "[", "data", "]"}], "^", "2"}], ",", 
   RowBox[{"BlurRadius", "->", "0.1"}], ",", 
   RowBox[{"QuarterMerge", "->", "None"}], ",", 
   RowBox[{"PlotRange", "->", "Full"}]}], "]"}]}], "Input",
 CellLabel->
  "In[200]:=",ExpressionUUID->"86a4db87-6e42-4425-a8c5-539805dfb8c0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BoolInv", ":=", 
   RowBox[{
    RowBox[{"#", "==", "0"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Bool", ":=", 
   RowBox[{
    RowBox[{"#", "!=", "0"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FromEdge", "[", 
    RowBox[{"ind_", ",", "ns_"}], "]"}], ":=", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"#1", "<", 
         RowBox[{"#2", "/", "2"}]}], ",", 
        RowBox[{"-", "#1"}], ",", 
        RowBox[{"#1", "-", "#2", "+", "1"}]}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"ind", ",", "ns"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Mask", "[", "hd_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ns", ",", "nCAP", ",", "eta", ",", "CAP", ",", "free"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ns", "=", 
       RowBox[{
        RowBox[{"hd", "[", "\"\<ns\>\"", "]"}], "/", 
        RowBox[{"hd", "[", "\"\<downscale\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nCAP", "=", 
       RowBox[{"ns", "/", "4"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"free", "=", 
       RowBox[{"BoolInv", "/@", 
        RowBox[{"hd", "[", "\"\<bounded\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eta", "=", 
       RowBox[{"Pick", "[", 
        RowBox[{
         RowBox[{"Power", "[", 
          RowBox[{
           RowBox[{"3.0", "/", "nCAP"}], ",", "4"}], "]"}], ",", "free"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CAP", ":=", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"eta", ".", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#", ">", "0"}], ",", 
                RowBox[{"#", "^", "4"}], ",", "0"}], "]"}], "&"}], ",", "#"}],
             "]"}]}]}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Array", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"s", "=", 
            RowBox[{"Pick", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nCAP", "+", 
                RowBox[{"FromEdge", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"List", "[", "##", "]"}], "-", "1"}], ",", "ns"}], 
                 "]"}]}], ")"}], ",", "free"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"AllTrue", "[", 
              RowBox[{"s", ",", "Negative"}], "]"}], ",", "1", ",", 
             RowBox[{"CAP", "[", "s", "]"}]}], "]"}]}], ")"}], "&"}], ",", 
        "ns"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InvMask", "[", "hd_", "]"}], ":=", 
   RowBox[{"1", "-", 
    RowBox[{"Mask", "[", "hd", "]"}]}]}], ";"}]}], "Input",
 CellLabel->
  "In[115]:=",ExpressionUUID->"6ba1fe10-a03b-4929-89f2-078525143378"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"WFShiftTrick", "[", "hd_", "]"}], ":=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"List", "[", "##", "]"}], "]"}], "+", "1"}], ",", "2"}], 
         "]"}], "2"}], "-", "1"}], "&"}], ",", 
     RowBox[{
      RowBox[{"hd", "[", "\"\<ns\>\"", "]"}], "/", 
      RowBox[{"hd", "[", "\"\<downscale\>\"", "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[138]:=",ExpressionUUID->"f91fc482-dba2-4898-947f-0577037d521a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"hd", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<ns\>\"", "->", 
      RowBox[{"{", 
       RowBox[{"16", ",", "16"}], "}"}]}], ",", 
     RowBox[{"\"\<bounded\>\"", "->", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], ",", 
     RowBox[{"\"\<downscale\>\"", "->", "1"}]}], "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ArrayPlot", "[", 
  RowBox[{
   RowBox[{"InvMask", "[", "hd", "]"}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", "Automatic"}]}], "]"}]}], "Input",
 CellLabel->
  "In[163]:=",ExpressionUUID->"65a228c3-43da-433c-be59-ce93acd1f9be"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "128"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nCAP", "=", 
   RowBox[{"n", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eta", "=", 
   RowBox[{"Power", "[", 
    RowBox[{
     RowBox[{"3.0", "/", "nCAP"}], ",", "4"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maska", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"n", "/", "2"}], "-", "i"}], "]"}], ">", 
        RowBox[{"n", "/", "4"}]}], ",", "1", ",", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"i", "-", 
               RowBox[{"n", "/", "2"}], "-", "0.5"}], ")"}], "4"]}], "eta"}], 
          "]"}]}], ")"}]}], "]"}], ",", 
     RowBox[{"Dimensions", "[", "data", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"maskaPlot", "=", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{"maska", ",", 
    RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}]}]}], "Input",ExpressionU\
UID->"2d173e6b-3590-49dd-9baf-b29320a611be"],

Cell[CellGroupData[{

Cell["1", "Chapter",ExpressionUUID->"fd035089-0370-45b2-b361-c2b26524aa0b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"trick", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"List", "[", "##", "]"}], "]"}], "+", "1"}], ",", "2"}], 
         "]"}], "2"}], "-", "1"}], "&"}], ",", 
     RowBox[{"Dimensions", "[", "maska", "]"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[88]:=",ExpressionUUID->"74141e0f-6f6c-442c-b618-832df3b3ce5e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"fd", "=", 
   RowBox[{"Fourier", "[", 
    RowBox[{
     RowBox[{"data", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}], "maska", " ", "trick"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Abs", "[", 
     RowBox[{
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], "maska"}], "]"}], "^", "2"}], 
   ",", "\[Infinity]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Abs", "[", "fd", "]"}], "^", "2"}], ",", "\[Infinity]"}], 
  "]"}]}], "Input",
 CellLabel->"In[89]:=",ExpressionUUID->"3254bcde-5861-405d-baea-9cfffb279f74"],

Cell[BoxData["1.0984651026276897`*^-12"], "Output",
 CellLabel->"Out[90]=",ExpressionUUID->"83ca82d0-eeaf-4112-b0f7-3e26de268d71"],

Cell[BoxData["1.0984651026276897`*^-12"], "Output",
 CellLabel->"Out[91]=",ExpressionUUID->"886cc17b-f653-4715-8341-f23b58995465"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ArrayPlot", "[", 
  RowBox[{
   RowBox[{"Abs", "[", "fd", "]"}], "^", "2"}], "]"}]], "Input",
 CellLabel->"In[92]:=",ExpressionUUID->"4faa00c3-51e0-4fa0-b805-37da247fa41e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ArrayPlot", "[", 
    RowBox[{
     RowBox[{"Fourier", "/@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "maska"}], ")"}]}], " ", ",", 
     RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], "]"}], "&"}], 
  "/@", "data"}]], "Input",
 CellLabel->"In[15]:=",ExpressionUUID->"3c38f0cc-377a-4f07-85e2-67c1e85349d6"],

Cell[BoxData[
 TemplateBox[{
  "Fourier", "fftl", 
   "\"Argument {<<3292840240 bytes>>} is not a non-empty list or rectangular \
array of numeric quantities.\"", 2, 15, 3, 17710587868313577760, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellLabel->
  "During evaluation of \
In[15]:=",ExpressionUUID->"d77c14bd-b001-47ea-9047-c422c5a95e9a"],

Cell[BoxData[
 TemplateBox[{
  "Fourier", "fftl", 
   "\"Argument {<<3292840240 bytes>>} is not a non-empty list or rectangular \
array of numeric quantities.\"", 2, 15, 4, 17710587868313577760, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellLabel->
  "During evaluation of \
In[15]:=",ExpressionUUID->"01c7fe86-4ef2-47ee-a356-9a01e3601c5b"],

Cell[BoxData[
 TemplateBox[{
  "Fourier", "fftl", 
   "\"Argument {<<3292840240 bytes>>} is not a non-empty list or rectangular \
array of numeric quantities.\"", 2, 15, 5, 17710587868313577760, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellLabel->
  "During evaluation of \
In[15]:=",ExpressionUUID->"f5fed14f-3451-40f3-ba4c-f28e955d4637"],

Cell[BoxData[
 RowBox[{"$Aborted", "[", "]"}]], "Message", "MSG",
 CellLabel->
  "During evaluation of \
In[15]:=",ExpressionUUID->"e73da25c-ac63-4c65-933f-d7c766d096ee"],

Cell[BoxData["$Aborted"], "Output",
 CellLabel->"Out[15]=",ExpressionUUID->"f10c7446-2743-4b51-9e9e-c145cc2553a8"],

Cell[BoxData["$Aborted"], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellLabel->
  "Out[109]=",ExpressionUUID->"172fd666-4651-4e5d-bf74-d69805c43092"],

Cell[BoxData["$Aborted"], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellLabel->"Out[86]=",ExpressionUUID->"e33d15b4-74f0-4244-86dc-8607e3ac86b6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"names", "=", 
  RowBox[{
  "FileNames", "[", 
   "\"\</Users/ranza/Projects/Quantum/QSF-examples/examples/argon-2e/Results/\
agh-transfergrid-es/fwhm_cycles_6.576000/phase_0.000000/momenta_scale8_repP.\
psi*\>\"", "]"}]}]], "Input",
 CellLabel->"In[33]:=",ExpressionUUID->"b1385488-9864-4867-8f50-59eb42432f7c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"/Users/ranza/Projects/Quantum/QSF-examples/examples/argon-2e/\
Results/agh-transfergrid-es/fwhm_cycles_6.576000/phase_0.000000/momenta_\
scale8_repP.psi0\"\>", 
   ",", "\<\"/Users/ranza/Projects/Quantum/QSF-examples/examples/argon-2e/\
Results/agh-transfergrid-es/fwhm_cycles_6.576000/phase_0.000000/momenta_\
scale8_repP.psi1\"\>", 
   ",", "\<\"/Users/ranza/Projects/Quantum/QSF-examples/examples/argon-2e/\
Results/agh-transfergrid-es/fwhm_cycles_6.576000/phase_0.000000/momenta_\
scale8_repP.psi2\"\>", 
   ",", "\<\"/Users/ranza/Projects/Quantum/QSF-examples/examples/argon-2e/\
Results/agh-transfergrid-es/fwhm_cycles_6.576000/phase_0.000000/momenta_\
scale8_repP.psi3\"\>"}], "}"}]], "Output",
 CellLabel->"Out[33]=",ExpressionUUID->"4ca29a69-c3f0-4c43-b216-bc820b31a90b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
  "\"\<common/wf.wls\>\""}]], "Input",
 CellLabel->
  "In[353]:=",ExpressionUUID->"19a041b1-095c-45e7-af8d-0a8128b28033"],

Cell[BoxData["\<\"/Users/ranza/Projects/Quantum/QSF-examples/QSF/plotting/\
common/wf.wls\"\>"], "Output",
 CellLabel->
  "Out[353]=",ExpressionUUID->"d6e67ec6-f928-42c2-8a64-5dcf16bc87dc"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\</Users/ranza/Projects/Quantum/QSF-examples/QSF/plotting/common/wf.wls\>\
\""}]], "Input",
 CellLabel->"In[30]:=",ExpressionUUID->"194a5c7a-ce38-48c8-bda1-18a74621b88e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"WFLoad", " ", "/@", 
    RowBox[{"Select", "[", 
     RowBox[{"names", ",", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"StringEndsQ", "[", 
         RowBox[{"#", ",", "\"\<0\>\""}], "]"}]}], "&"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ArrayPlot", "[", 
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "2", "]"}], "]"}], " ", ",", 
     RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], "]"}], "&"}], 
  "/@", "data"}]}], "Input",
 CellLabel->"In[37]:=",ExpressionUUID->"3fb1c8f0-a782-441d-bdd1-649d793fafa7"],

Cell[BoxData[
 RowBox[{"ArrayPlot", "[", 
  RowBox[{
   RowBox[{"Total", "[", 
    RowBox[{"MapIndexed", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "@", "#2"}], "<", "3"}], ",", "0.01", ",", "1"}], 
         "]"}], "*", "#1"}], "&"}], ",", " ", 
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}], " ", "]"}], ",", 
   " ", 
   RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], "]"}]], "Input",\

 CellLabel->"In[39]:=",ExpressionUUID->"bc612620-d864-4923-8b30-3767ad15c331"]
}, Open  ]]
},
WindowSize->{1680, 847},
WindowMargins->{{Automatic, -240}, {Automatic, -270}},
InputAliases->{"intt" -> RowBox[{"\[Integral]", 
     RowBox[{"\[SelectionPlaceholder]", 
       RowBox[{"\[DifferentialD]", "\[Placeholder]"}]}]}], "dintt" -> 
  RowBox[{
     SubsuperscriptBox[
     "\[Integral]", "\[SelectionPlaceholder]", "\[Placeholder]"], 
     RowBox[{"\[Placeholder]", 
       RowBox[{"\[DifferentialD]", "\[Placeholder]"}]}]}], "rintt" -> 
  RowBox[{
     UnderscriptBox["\[Integral]", 
      RowBox[{"\[SelectionPlaceholder]", "\[Element]", "\[Placeholder]"}]], 
     "\[Placeholder]"}], "sumt" -> RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"\[SelectionPlaceholder]", "=", "\[Placeholder]"}], 
      "\[Placeholder]"], "\[Placeholder]"}], "prodt" -> RowBox[{
     UnderoverscriptBox["\[Product]", 
      RowBox[{"\[SelectionPlaceholder]", "=", "\[Placeholder]"}], 
      "\[Placeholder]"], "\[Placeholder]"}], "dt" -> RowBox[{
     SubscriptBox["\[PartialD]", "\[SelectionPlaceholder]"], 
     "\[Placeholder]"}], "cbrt" -> 
  RadicalBox[
   "\[SelectionPlaceholder]", "3", SurdForm -> True, MultilineFunction -> 
    None], "surd" -> 
  RadicalBox[
   "\[SelectionPlaceholder]", "\[Placeholder]", SurdForm -> True, 
    MultilineFunction -> None], "ket" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "Ket"], "bra" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "Bra"], "braket" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[Placeholder]"}, "BraKet"], 
  "delay" -> TemplateBox[{"\[SelectionPlaceholder]"}, "SystemsModelDelay"], 
  "grad" -> RowBox[{
     SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], "\[Placeholder]"}], 
  "del." -> RowBox[{
     SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], ".", 
     "\[Placeholder]"}], "delx" -> RowBox[{
     SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], "\[Cross]", 
     "\[Placeholder]"}], "del2" -> RowBox[{
     SubsuperscriptBox["\[Del]", "\[SelectionPlaceholder]", 2], 
     "\[Placeholder]"}], "kd" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "KroneckerDeltaSeq"], "algs" -> 
  TemplateBox[{}, "Algebraics"], "bools" -> TemplateBox[{}, "Booleans"], 
  "comps" -> TemplateBox[{}, "Complexes"], "ints" -> 
  TemplateBox[{}, "Integers"], "pris" -> TemplateBox[{}, "Primes"], "rats" -> 
  TemplateBox[{}, "Rationals"], "reals" -> TemplateBox[{}, "Reals"], "pints" -> 
  TemplateBox[{}, "PositiveIntegers"], "npints" -> 
  TemplateBox[{}, "NonPositiveIntegers"], "nnints" -> 
  TemplateBox[{}, "NonNegativeIntegers"], "nints" -> 
  TemplateBox[{}, "NegativeIntegers"], "prats" -> 
  TemplateBox[{}, "PositiveRationals"], "nprats" -> 
  TemplateBox[{}, "NonPositiveRationals"], "nnrats" -> 
  TemplateBox[{}, "NonNegativeRationals"], "nrats" -> 
  TemplateBox[{}, "NegativeRationals"], "preals" -> 
  TemplateBox[{}, "PositiveReals"], "npreals" -> 
  TemplateBox[{}, "NonPositiveReals"], "nnreals" -> 
  TemplateBox[{}, "NonNegativeReals"], "nreals" -> 
  TemplateBox[{}, "NegativeReals"], "dlim" -> RowBox[{
     UnderscriptBox["\[Limit]", 
      RowBox[{"\[SelectionPlaceholder]", 
        UnderscriptBox["\[Rule]", 
         TemplateBox[{}, "Integers"]], "\[Infinity]"}]], "\[Placeholder]"}], 
  "dMlim" -> RowBox[{
     UnderscriptBox["\[MaxLimit]", 
      RowBox[{"\[SelectionPlaceholder]", 
        UnderscriptBox["\[Rule]", 
         TemplateBox[{}, "Integers"]], "\[Infinity]"}]], "\[Placeholder]"}], 
  "dmlim" -> RowBox[{
     UnderscriptBox["\[MinLimit]", 
      RowBox[{"\[SelectionPlaceholder]", 
        UnderscriptBox["\[Rule]", 
         TemplateBox[{}, "Integers"]], "\[Infinity]"}]], "\[Placeholder]"}], 
  "tue" -> OverscriptBox["\[UndirectedEdge]", "\[Placeholder]"], "tde" -> 
  OverscriptBox["\[DirectedEdge]", "\[Placeholder]"], "cB" -> 
  TemplateBox[{}, "CombinatorB"], "cC" -> TemplateBox[{}, "CombinatorC"], 
  "cI" -> TemplateBox[{}, "CombinatorI"], "cK" -> 
  TemplateBox[{}, "CombinatorK"], "cS" -> TemplateBox[{}, "CombinatorS"], 
  "cW" -> TemplateBox[{}, "CombinatorW"], "cY" -> 
  TemplateBox[{}, "CombinatorY"], "notation" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongLeftRightArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "notation>" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongRightArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "notation<" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongLeftArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "symb" -> RowBox[{"Symbolize", "[", 
     TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], "]"}], 
  "infixnotation" -> RowBox[{"InfixNotation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], ",", 
       "\[Placeholder]"}], "]"}], "addia" -> RowBox[{"AddInputAlias", "[", 
     RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "pattwraper" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "NotationPatternTag"], 
  "madeboxeswraper" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "NotationMadeBoxesTag"], "cf" -> 
  SubscriptBox["&", "\[Placeholder]"]},
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"ddd5a2c8-7dca-4180-a2bf-cf3726b77d7f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 209, 5, 30, "Input",ExpressionUUID->"fc30adb5-f356-4a89-98af-34b8532380ad"],
Cell[CellGroupData[{
Cell[792, 29, 1563, 45, 158, "Input",ExpressionUUID->"71237251-7199-4833-bd13-1dd58f08a8a7"],
Cell[2358, 76, 128, 1, 34, "Output",ExpressionUUID->"ea479790-6bef-4f0f-97e4-c7d23367ad25"],
Cell[2489, 79, 128, 1, 34, "Output",ExpressionUUID->"e89f87e5-91f6-4e21-82e5-ca9f744bdd0a"],
Cell[2620, 82, 127, 1, 34, "Output",ExpressionUUID->"4a6e905f-7098-4892-8d66-79e0149258ee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2784, 88, 81, 0, 30, "Input",ExpressionUUID->"35226616-dbd9-44ec-8f82-1a1b817c99bc"],
Cell[2868, 90, 188, 3, 34, "Output",ExpressionUUID->"25f59059-8b01-47c4-a4ca-cef4798a91a4"]
}, Open  ]],
Cell[3071, 96, 100, 0, 52, "Input",ExpressionUUID->"c6bcf3ba-3130-4a7f-a6f9-b8de73ce5269"],
Cell[CellGroupData[{
Cell[3196, 100, 838, 19, 115, "Input",ExpressionUUID->"8cd1cd22-1d99-4dbf-a0f5-33ae6594e39b"],
Cell[4037, 121, 171, 3, 34, "Output",ExpressionUUID->"6b9f60a3-95c9-46a0-afb6-4a4e04c037b3"],
Cell[4211, 126, 124, 2, 34, "Output",ExpressionUUID->"b7d0f4e2-8098-41de-b0bd-86f0b5e90829"],
Cell[4338, 130, 117, 1, 34, "Output",ExpressionUUID->"6d2ae8f5-c30a-4c84-829c-511a3266b4ab"],
Cell[4458, 133, 119, 1, 34, "Output",ExpressionUUID->"e0bd2d5b-edda-49a2-88cf-45e3c13c95c5"],
Cell[4580, 136, 117, 1, 34, "Output",ExpressionUUID->"3b5f1a44-1d2b-47eb-bcc9-dc51ac22909a"]
}, Open  ]],
Cell[4712, 140, 91, 0, 30, "Input",ExpressionUUID->"944ff032-276f-4096-872b-87059ec1972a"],
Cell[4806, 142, 246, 6, 30, "Input",ExpressionUUID->"e91c5e31-fae7-424a-add7-75adb91b70e8"],
Cell[CellGroupData[{
Cell[5077, 152, 3810, 113, 346, "Input",ExpressionUUID->"dbb721f6-afc4-46a9-9169-88d3a7840ca4"],
Cell[8890, 267, 1847, 42, 185, "Output",ExpressionUUID->"ddb63452-e1bc-4ba3-b19b-805e9dddd469"],
Cell[10740, 311, 1502, 29, 82, "Message",ExpressionUUID->"a16cf9e6-327a-47b3-ad9b-9aa8f2e8cb69"],
Cell[12245, 342, 121, 2, 34, "Output",ExpressionUUID->"11761035-4465-47e5-b494-ea2fa127a249"],
Cell[12369, 346, 1838, 41, 185, "Output",ExpressionUUID->"1f318627-aeff-4c69-b509-a453fb60514d"]
}, Open  ]],
Cell[14222, 390, 98, 0, 30, "Input",ExpressionUUID->"e976654a-f134-4368-89e5-c3f2f5ef3ef8"],
Cell[14323, 392, 4710, 116, 325, "Input",ExpressionUUID->"97aa1c20-4c2f-4af9-bf33-9ab69ad80752"],
Cell[19036, 510, 81, 0, 30, "Input",ExpressionUUID->"31a816a4-26d8-45b8-8807-d38e0c2a1eaf"],
Cell[CellGroupData[{
Cell[19142, 514, 3673, 96, 309, "Input",ExpressionUUID->"3fa5c69b-90e6-452a-9207-8805b7ae0b21"],
Cell[CellGroupData[{
Cell[22840, 614, 280, 5, 26, "Echo",ExpressionUUID->"fbf04b2a-0e1d-478e-b7a3-cde50950ad34"],
Cell[23123, 621, 280, 5, 26, "Echo",ExpressionUUID->"4139d819-7776-416d-8e05-d80637affe67"],
Cell[23406, 628, 279, 5, 26, "Echo",ExpressionUUID->"61c49d5f-ecb1-486a-a317-7a1017336e46"],
Cell[23688, 635, 278, 5, 26, "Echo",ExpressionUUID->"2106d3af-0a1f-442c-a414-46fbd0798b38"],
Cell[23969, 642, 278, 5, 26, "Echo",ExpressionUUID->"5c6b80b8-bc79-4e92-a70d-c5a4e3dab5af"],
Cell[24250, 649, 279, 5, 26, "Echo",ExpressionUUID->"5277820d-5f1a-4eb6-8644-26980f216f5c"],
Cell[24532, 656, 275, 5, 25, "Echo",ExpressionUUID->"b4934d03-426c-402a-aa6b-112470ae27a0"],
Cell[24810, 663, 259, 5, 25, "Echo",ExpressionUUID->"436acaef-f50b-4dbb-b628-b581cc44c7d6"]
}, Open  ]],
Cell[25084, 671, 331, 9, 34, "Output",ExpressionUUID->"680551f4-8b8a-4b62-8def-2c18642da5ee"]
}, Open  ]],
Cell[25430, 683, 4143, 106, 267, "Input",ExpressionUUID->"bbb7c1af-716f-4190-a466-6711a6930c36"],
Cell[CellGroupData[{
Cell[29598, 793, 5107, 146, 304, "Input",ExpressionUUID->"1430645c-8ee1-4ba3-a2e7-99efd4441f81"],
Cell[34708, 941, 687, 12, 98, "Output",ExpressionUUID->"70a82965-16f2-4e96-9356-f0007dd08c65"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35432, 958, 5177, 148, 325, "Input",ExpressionUUID->"419c8120-2d78-4e18-a4d3-fb3ff642a526"],
Cell[40612, 1108, 118, 2, 34, "Output",ExpressionUUID->"dbd92f43-119b-4e29-90d1-b99ef104d4f0"],
Cell[40733, 1112, 926, 18, 35, "Message",ExpressionUUID->"f14843ee-bb1f-4663-9f4c-04732a4eb5fc"]
}, Open  ]],
Cell[41674, 1133, 679, 18, 52, "Input",ExpressionUUID->"86a4db87-6e42-4425-a8c5-539805dfb8c0"],
Cell[42356, 1153, 3228, 94, 304, "Input",ExpressionUUID->"6ba1fe10-a03b-4929-89f2-078525143378"],
Cell[45587, 1249, 632, 20, 30, "Input",ExpressionUUID->"f91fc482-dba2-4898-947f-0577037d521a"],
Cell[46222, 1271, 619, 18, 52, "Input",ExpressionUUID->"65a228c3-43da-433c-be59-ce93acd1f9be"],
Cell[46844, 1291, 1323, 40, 117, "Input",ExpressionUUID->"2d173e6b-3590-49dd-9baf-b29320a611be"],
Cell[CellGroupData[{
Cell[48192, 1335, 75, 0, 69, "Chapter",ExpressionUUID->"fd035089-0370-45b2-b361-c2b26524aa0b"],
Cell[48270, 1337, 513, 15, 30, "Input",ExpressionUUID->"74141e0f-6f6c-442c-b618-832df3b3ce5e"],
Cell[CellGroupData[{
Cell[48808, 1356, 737, 23, 73, "Input",ExpressionUUID->"3254bcde-5861-405d-baea-9cfffb279f74"],
Cell[49548, 1381, 130, 1, 34, "Output",ExpressionUUID->"83ca82d0-eeaf-4112-b0f7-3e26de268d71"],
Cell[49681, 1384, 130, 1, 34, "Output",ExpressionUUID->"886cc17b-f653-4715-8341-f23b58995465"]
}, Open  ]],
Cell[49826, 1388, 196, 4, 30, "Input",ExpressionUUID->"4faa00c3-51e0-4fa0-b805-37da247fa41e"],
Cell[CellGroupData[{
Cell[50047, 1396, 429, 12, 30, "Input",ExpressionUUID->"3c38f0cc-377a-4f07-85e2-67c1e85349d6"],
Cell[50479, 1410, 350, 8, 30, "Message",ExpressionUUID->"d77c14bd-b001-47ea-9047-c422c5a95e9a"],
Cell[50832, 1420, 350, 8, 30, "Message",ExpressionUUID->"01c7fe86-4ef2-47ee-a356-9a01e3601c5b"],
Cell[51185, 1430, 350, 8, 30, "Message",ExpressionUUID->"f5fed14f-3451-40f3-ba4c-f28e955d4637"],
Cell[51538, 1440, 170, 4, 21, "Message",ExpressionUUID->"e73da25c-ac63-4c65-933f-d7c766d096ee"],
Cell[51711, 1446, 114, 1, 34, "Output",ExpressionUUID->"f10c7446-2743-4b51-9e9e-c145cc2553a8"],
Cell[51828, 1449, 168, 4, 34, "Output",ExpressionUUID->"172fd666-4651-4e5d-bf74-d69805c43092"],
Cell[51999, 1455, 164, 3, 34, "Output",ExpressionUUID->"e33d15b4-74f0-4244-86dc-8607e3ac86b6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52200, 1463, 335, 7, 30, "Input",ExpressionUUID->"b1385488-9864-4867-8f50-59eb42432f7c"],
Cell[52538, 1472, 824, 14, 98, "Output",ExpressionUUID->"4ca29a69-c3f0-4c43-b216-bc820b31a90b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53399, 1491, 195, 5, 30, "Input",ExpressionUUID->"19a041b1-095c-45e7-af8d-0a8128b28033"],
Cell[53597, 1498, 189, 3, 34, "Output",ExpressionUUID->"d6e67ec6-f928-42c2-8a64-5dcf16bc87dc"]
}, Open  ]],
Cell[53801, 1504, 205, 4, 30, "Input",ExpressionUUID->"194a5c7a-ce38-48c8-bda1-18a74621b88e"],
Cell[54009, 1510, 639, 19, 52, "Input",ExpressionUUID->"3fb1c8f0-a782-441d-bdd1-649d793fafa7"],
Cell[54651, 1531, 640, 19, 30, "Input",ExpressionUUID->"bc612620-d864-4923-8b30-3767ad15c331"]
}, Open  ]]
}
]
*)

